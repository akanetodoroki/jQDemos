pxmlfile="xml//resource.xml";sysdbname="melab";syshostname="localhost";syssqlpassword="sql2008";sysdatabasestring=syshostname+"	"+syssqlpassword+"	"+sysdbname;rowHeight=32;colWidth=8;pmyWidth={};sysdateformat="Y-n-j";sysfulldateformat="Y-m-d";syslabel={};systext={};sysbutton={};syslabel.fontname="宋体";syslabel.topmargin=4;syslabel.align="left";syslabel.fontsize=13;syslabel.fontbold=false;systext.fontname="Times New roman";systext.height=24;systext.rowheight=36;sysbutton.height=24;sysbutton.width=65;sys={};sys.browser=myCheckBrowser();if(sys.browser=="firefox"){sys.dateformat="Y-m-d";}else{if(sys.browser=="ie"){sys.dateformat="Y/m/d";}}sys.windowcon="movie.png";sys.theme={theme:"default"};sys.fusionchartno=1;sys.tab=String.fromCharCode(9);sys.ftab="["+String.fromCharCode(9)+"]";sys.vtab="["+String.fromCharCode(9)+"]";sys.sqltab="@"+String.fromCharCode(9)+"@";sys.gridcellpix=6;sys.treemenuwidth=190;sys.urlpath="";sys.project="";url=window.location.pathname;arrUrl=url.split("/");if(arrUrl.length>1){sys.project=arrUrl[1];}sys.userid="";sys.useraccount="admin",sys.username="admin";sys.userright="";sys.usertype="";sys.userpassword="";sys.userlogindate="";sys.useraction="";sys.usernotes="";sys.realpath="";sys.path=url;sys.urlright="";sys.menuurl="";sys.buttonright="";sys.screenwidth=window.screen.width;sys.screenheight=window.screen.height;sys.windowheight=sysGetWinSize().h;sys.windowwidth=sysGetWinSize().w;sys.menubutton=["addflag","updateflag","deleteflag","reviewflag","uploadflag","downloadflag","printflag"];sys.chnnumber=["一","二","三","四","五","六","七","八","九","十"];sys.keyeventcmp=";text;combo;combobox;numberbox;datebox;textbox;password;";sys.maxfilenumber=100;sys.cmp=["textfield","combo","combofield","label","labelfield","readonlyfield","displayfield","linkfield","textpicker","gridpicker","treepicker","editbutton","checkbox","memofield","memo","sysuser","sysdate","sysusername","sysnumber","fileupload","filedownload","filefield","imageupload","datefield","password","numberfield","decimalfield","rmb","rmbfield","totalfields","summaryfields","spinfield","report","footer","groupbox","tab","form"];sys.xattrs=["title","text","label","length","value","blanktext","minvalue","maxvalue","filename","datafields","nodefields","filterfields","sortfield","style","rmb","sumfields","avgfields","countfields","maxfields","minfields","summarycolumn","keyfield","lockedfields","decimal","sql","items","valuefields","labelwidth","masterfield","url","font","rule","rowheight","checkbox","modal","align","table","documentdate","reviewfields","format","titlerows","titlefont"];sys.editableColumnfields="/textfield/datefield/decimalfield/numberfield/combo/combofield/editbutton/";syspath={};syspath.master="mybase//";syspath.teachers="mybase//photos//teachers//";syspath.students="mybase//photos//students//";syspath.labs="mybase//labs//";syspath.contacts="mybase//contacts//";syspath.employees="mybase//employees//";syspath.products="mybase//products//";syspath.activities="mybase//activities//";syspath.services="mybase//services//";syspath.customers="mybase//customers//";syspath.collections="mybase//collections//";syspath.orders="mybase//orders//";syspath.faqs="mybase//faqs//";syspath.troubles="mybase//troubles//";syspath.invoices="mybase//invoices//";syspath.resources="mybase//resources//";sysfilenotfound="system//images//filenotfound.png";prowppx=26;pcolppx=7;pgridrowheight=21;pwinheight=600;pwinwidth=800;pitemsPerPage=20;maxReturnNumber=20;function myCheckBrowser(){var b=navigator.userAgent.toLowerCase();var a=navigator.userAgent;if(b.indexOf("msie")>=0&&b.indexOf("opera")<0){a="ie";}else{if(b.indexOf("firefox")>=0){a="firefox";}else{if(b.indexOf("opera")>=0){a="opera";}else{if(b.indexOf("chrome")>=0){a="chrome";}else{if(b.indexOf("safari")>=0){a="safari";}}}}}return(a);}function sysGetWinSize(){var a={};a.w=0;a.h=0;if(window.innerHeight){a.h=window.innerHeight;}else{if((document.body)&&(document.body.clientHeight)){a.h=document.body.clientHeight;}}if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth){a.h=document.documentElement.clientHeight;}if(window.innerWidth){a.w=window.innerWidth;}else{if((document.body)&&(document.body.clientWidth)){a.w=document.body.clientWidth;}}if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth){a.w=document.documentElement.clientWidth;}return(a);}function myBanBackSpace(d){var g=d||window.event;var c=g.target||g.srcElement;var h=c.type||c.getAttribute("type");var f=c.readOnly;var k=c.disabled;f=(f==undefined)?false:f;k=(k==undefined)?true:k;var b=g.keyCode==8&&(h=="password"||h=="text"||h=="textarea")&&(f==true||k==true);var a=g.keyCode==8&&h!="password"&&h!="text"&&h!="textarea";var i=(g.keyCode==33||g.keyCode==34)&&h=="textarea"&&mycheckBrowser()=="chrome";if(a||b||i){return false;}}function trim(a){if(a!=undefined){return a.replace(/(^\s*)|(\s*$)/g,"");}else{return"";}}String.prototype.replaceAll=function(str1,str2){var str=this;if(str==undefined){str="";}var result=str.replace(eval("/"+str1+"/gi"),str2);return result;};function myToSqlValue(a){if(a==undefined){a="";}a=a.replace(/\n/g,"<br>");a=a.replaceAll("'","''");return a;}function mySpace(c){var b="";for(var a=1;a<=c;a++){b+="&nbsp;";}return b;}function myToUnicode(d){var a="";if(d!=""){for(var b=0;b<d.length;b++){var c=parseInt(d[b].charCodeAt(0),10).toString(16);a+=c.substr(0,4);}}return a;}function xmyToChn(d){var a="";if(d!=""){for(var b=0;b<d.length;b++){var c=d.substr(b*4,4);c=c.replace("%","");a+=String.fromCharCode(parseInt(c,16).toString(10));}}return a;}function mySysDateTime(k){var b=new Date();var a=b.getMilliseconds();var i=b.getFullYear();var c=(b.getMonth()+1)+"";var g=b.getDate()+"";if(c.length<2){c="0"+c;}if(g.length<2){g="0"+g;}var e=b.getHours()+"";var f=b.getMinutes()+"";var o=b.getSeconds()+"";if(e.length<2){e="0"+e;}if(f.length<2){f="0"+f;}if(o.length<2){o="0"+o;}var l=e+":"+f+":"+o+":"+a;var n="";if(k=="date"){n=i+"-"+c+"-"+g;}else{if(k=="time"){n=l;}else{if(k=="fulltime"){n=i+"-"+c+"-"+g+"-"+e+"-"+f+"-"+o+"-"+a;}else{if(k=="second"){n=b.getTime();}else{n=i+"-"+c+"-"+g+" "+l;}}}}return n;}function dateadd(c,h){c=c.replace(/-/g,"/");var f=new Date(c);f=f.valueOf();f=f+h*24*60*60*1000;f=new Date(f);var g=f.getFullYear();var a=f.getMonth()+1;var e=f.getDate();if(a<=9){a="0"+a;}if(e<=9){e="0"+e;}var b=g+"-"+a+"-"+e;return b;}function myDateboxValue(e,d){var a="";if(d==undefined||d==""){var d="long";}if($("#"+e).length>0){var c=$("#"+e).textbox("getValue");var b=c.split("-");if(b.length==3){if(b[1].length<2){b[1]="0"+b[1];}if(b[2].length<2){b[2]="0"+b[2];}if(d=="long"||d=="day"){a=b[0]+"年"+b[1]+"月"+b[2]+"日";}else{if(d=="month"){a=b[0]+"年"+b[1]+"月";}else{if(d=="year"){a=b[0]+"年";}}}}}return a;}function myMessage(msg,icon,width,callback){var title="系统提示";if(callback==undefined){callback="myMessageEvent";}if(msg.constructor==window.Array){var str="";for(var i=0;i<msg.length;i++){if(i>0){str+="@n";}str+=msg[i];}str=str.replaceAll("<br>","@n");}else{var str=msg;}var tmp=str.split("@n");if(icon==undefined||icon==""){var icon="info";}else{if(icon=="warn"){icon="warning";}else{if(icon=="alert"){icon="info";}}}var k=0;str="";for(var i=0;i<tmp.length;i++){var s=tmp[i].replaceAll(" ","&nbsp;");if(tmp[i]==""){s='<div style="margin:5px 0px 0px 0px;"></div>';}else{if(k==1){s='<div style="margin:0px 12px 5px 0px;">'+s+"</div>";}else{if(tmp.length==1){s='<div style="margin:8px 12px 5px 0px;">'+s+"</div>";}else{s='<div style="margin:0px 0px 5px 30px;">'+s+"</div>";}}}s="<center>"+s+"</center>";if(tmp[i]!=""){k++;}str+=s;}if(width!=undefined&&width>0){$.messager.alert({title:title,msg:str+"<br>",width:width,icon:icon,fn:eval(callback)});}else{$.messager.alert({title:title,msg:str,icon:icon,fn:eval(callback)});}}function myMessageEvent(){}function myMessageShow(b,a){if(a==undefined||a==0){a=200;}$.messager.show({title:"系统提示",width:a,msg:"<center>"+b+"</center>",timeout:2000,showType:"slide"});}function myDefineLabelStyle(d,c,a,b){var e="";if(d!=undefined&&c!=undefined){e+='style=\\"';if(syslabel.fontbold){e+="font-weight:bold; ";}e+="font-size: "+syslabel.fontsize+"px; font-family: "+syslabel.fontname+"; TOP: "+d+"px; LEFT: "+c+"px; ";if(a!=undefined&&a>0){e+=" height: "+a+"px;";}if(b!=undefined&&b>0){e+=" width: "+b+"px;";}e+=" position: absolute";}return e;}function myLabel(g,c,a,e,d,b){if(c==""){c="document.body";}if(b==undefined){var b="";}else{b=";"+b+";";}var f="";f+="<label id='"+g+"' align='left'>";if(b.indexOf(";b;")>=0){f+="<b>";}if(b.indexOf(";u;")>=0){f+="<u>";}if(b.indexOf(";i;")>=0){f+="<i>";}if(b.indexOf(";a;")>=0){f+="<a>";}f+=a;if(b.indexOf(";a;")>=0){f+="</a>";}if(b.indexOf(";i;")>=0){f+="</i>";}if(b.indexOf(";u;")>=0){f+="</u>";}if(b.indexOf(";b;")>=0){f+="</b>";}f+="</label>";$("#"+c).append($(f));$("#"+g).css(myLabelCss(c,e,d,0,0));$("#"+g).attr("type","label");$("#"+g).attr("xparent",c);$("#"+g).attr("xid",g);}function myLabelCss(parent,top,left,height,width){var css="";if(sys.browser=="firefox"&&parent!=undefined&&$("#"+parent).length>0&&$("#"+parent).attr("type")=="fieldset"){top=top-16;}var str='var css={position: "absolute"';if(syslabel.fontbold){str+=", font-weight:bold";}str+=', "font-size":'+syslabel.fontsize+', "font-family":"'+syslabel.fontname+'"';if(top!=undefined&&left!=undefined){str+=', "top":'+top+', "left":'+left;if(width!=undefined&&width>0){str+=', "width": '+width;}if(height!=undefined&&height>0){str+=', "height": '+height;}str+=', "z-index":2};\n';}else{str+="};\n";}eval(str);return css;}function myTextCss(parent,top,left,height,width){var str="";var css="";if(top!=undefined&&left!=undefined){if(sys.browser=="firefox"&&parent!=undefined&&$("#"+parent).length>0&&$("#"+parent).attr("type")=="fieldset"){top=top-16;}str='var css={padding:"0px 2px 0px 4px", position: "absolute", top:"'+top+'px", left:"'+left+'px"';if(width!=undefined&&width>0){str+=", width: "+width;}if(height!=undefined&&height>0){str+=", height: "+height;}str+=', "z-index":2};\n';}else{str+="\n";}eval(str);return css;}function myFieldStyle(g,f){if(f!=undefined&&f!=""){var d=(f+";").split(";");for(var c=0;c<d.length;c++){if(d[c]=="readonly"){$("#"+g).textbox({readonly:true});$("#"+g).attr("xreadonly",true);}if(d[c]=="email"){$("#"+g).textbox({validType:"email"});}if(d[c]=="url"){$("#"+g).textbox({validType:"url"});}if(d[c]=="password"){$("#"+g).textbox({type:"password"});}if(d[c].indexOf("icon:")>=0){var b=d[c].indexOf("icon:");var a=d[c].indexOf(";",b+1);if(b>=0&&a>0){var e=d[c].substring(b+5,a-1);}else{var e=d[c].substr(b+5,255);}$("#"+g).textbox({buttonIcon:e});}}}}function myFieldLabel(h,e,b,d,g,f,a,c){if(b!=undefined&&b!=""){if(b.substr(0,1)=="*"){b=b.substring(1);$("#"+e).append("<label id='xlabel"+h+"' align='"+syslabel.align+"'>*</label>");$("#xlabel"+h).css(myLabelCss(e,g+syslabel.topmargin,f+d+c+12,0,0));}$("#"+e).append("<label id='label"+h+"' align='"+syslabel.align+"'>"+b+"</label>");if(d>0){$("#label"+h).css(myLabelCss(e,g+syslabel.topmargin,f,0,d));}else{$("#label"+h).css(myLabelCss(e,g,1*f+2,0,b.length*syslabel.fontsize));g=1*(g+syslabel.fontsize+syslabel.topmargin);}}else{d=0;}}function myHiddenFields(a){var e="";var d="main";var b=a.split(";");for(var c=0;c<b.length;c++){e='<input hidden="true" type="hidden" id="'+b[c]+'" style="left:0px; top:0px; height:0px; width:0px; padding:0px 0;" />';$("#"+d).append($(e));$("#"+b[c]).attr("xid",b[c]);}}function myTextField(b,i,g,k,f,d,l,c,h,a){var e="";if(i==""){i="main";}if(l==0){l=systext.height;}if(k==0&&g!=""){myFieldLabel(b,i,g,k,f,d+2,l,c);f=1*(f+syslabel.fontsize+syslabel.topmargin+2);k=0;}else{myFieldLabel(b,i,g,k,f,d,l,c);}e+='<div id="'+b+'_div" style="margin:0; padding:0;" ><input ';if(h!=undefined&&h!=""){e+=' value="'+h+'"';}e+=' class="easyui-validatebox easyui-textbox" type="text" id="'+b+'" style="margin:0px 0px 0px 0px; padding:0px 6px 0px 6px;" ></div>';$("#"+i).append($(e));$("#"+b+"_div").css(myTextCss(i,f,1*(d+k),l,c));$("#"+b).css({height:"100%",width:"100%"});$("#"+b).textbox({height:l});$("#"+b).attr("xparent",i);$("#"+b).attr("xlabel",g);$("#"+b).attr("xid",b);if(h!=undefined&&h!=""){}if(a!=undefined){myFieldStyle(b,a);}}function myDateField(b,i,g,k,f,d,l,c,h,a){var e="";if(i==""){i="main";}if(l==0){l=systext.height;}if(k==0&&g!=""){myFieldLabel(b,i,g,k,f,d+2,l,c);f=1*(f+syslabel.fontsize+syslabel.topmargin+2);k=0;}else{myFieldLabel(b,i,g,k,f,d,l,c);}e+='<div id="'+b+'_div"><input ';if(h!=undefined&&h!=""){e+=' value="'+h+'"';}e+=' class="easyui-datebox" type="text" id="'+b+'" style="padding:0px 6px 0px 6px;" ></div>';$("#"+i).append($(e));$("#"+b+"_div").css(myTextCss(i,f,1*(d+k),l,c));$("#"+b).datebox({height:l,width:c});$("#"+b).attr("xparent",i);$("#"+b).attr("xlabel",g);$("#"+b).attr("xid",b);if(h!=undefined&&h!=""){}myFieldStyle(b,a);}function myMemoField(b,h,f,i,e,d,k,c,g,a){myTextareaField(b,h,f,i,e,d,k,c,g,a);}function myTextareaField(b,i,g,k,f,d,l,c,h,a){var e="";if(i==""){i="main";}if(l==0){l=systext.height;}if(k==0&&g!=""){myFieldLabel(b,i,g,k,f,d+2,l,c);f=1*(f+syslabel.fontsize+syslabel.topmargin+2);k=0;}else{myFieldLabel(b,i,g,k,f,d,l,c);}var e='<div id="'+b+'_div"><textarea ';if(h!=undefined&&h!=""){e+=' value="'+h+'"';}e+=' id="'+b+'" style="resize:none; padding:5px 5px 0px 5px;" ></textarea></div>';$("#"+i).append($(e));$("#"+b+"_div").css(myTextCss(i,f,1*(d+k),l,c));$("#"+b).css({height:l,width:c});$("#"+b).attr("type","textarea");$("#"+b).attr("xparent",i);$("#"+b).attr("xlabel",g);$("#"+b).attr("xid",b);if(h!=undefined&&h!=""){$("#"+b).val(h);}myFieldStyle(b,a);}function myNumberField(b,n,l,o,k,e,p,c,d,g,m,f,i,a){var h="";if(p==0){p=systext.height+2;}if(n==""){n="main";}if(o==0&&l!=""){myFieldLabel(b,n,l,o,k,e+2,p,c);k=1*(k+syslabel.fontsize+syslabel.topmargin+2);o=0;}else{myFieldLabel(b,n,l,o,k,e,p,c);}h+='<div id="'+b+'_div"><input ';if(m!=undefined&&m!=""){h+=' value="'+m+'"';}h+=' class="easyui-numberbox" type="text" id="'+b+'" style="text-align:right; padding:0px 4px 0px 4px;" ';if(m!=""){h+=" value='"+m+"'";}h+='\n data-options="';if(g>0){h+="precision:"+g+"";}else{h+="precision:0";}if(!isNaN(f)){h+=",min:"+f+"";}if(!isNaN(i)){h+=",max:"+i+"";}h+='"></div>\n';$("#"+n).append($(h));$("#"+b+"_div").css(myTextCss(n,k,1*(e+o),p,c));$("#"+b).numberbox({height:p,width:c});$("#"+b).numberbox("textbox").css("text-align","right");$("#"+b).attr("xparent",n);$("#"+b).attr("xlabel",l);$("#"+b).attr("xid",b);}function myNumericField(b,m,k,n,i,e,o,c,d,g,l,f,h,a){myNumberField(b,m,k,n,i,e,o,c,d,g,l,f,h,a);}function mySearchField(b,i,g,k,f,d,l,c,h,a){var e="";if(i==""){i="main";}if(l==0){l=systext.height;}if(k==0&&g!=""){myFieldLabel(b,i,g,k,f,d+2,l,c);f=1*(f+syslabel.fontsize+syslabel.topmargin+2);k=0;}else{myFieldLabel(b,i,g,k,f,d,l,c);}e+='<div id="'+b+'_div"><input ';e+=' class="easyui-searchbox easyui-textbox" data-options="prompt:\''+h+'\'" id="'+b+'" style="margin:0px 0px 0px 0px; padding:0px 6px 0px 6px;" ></div>';$("#"+i).append($(e));$("#"+b+"_div").css(myTextCss(i,f,1*(d+k),l,c));$("#"+b).css({height:"100%",width:"100%"});$("#"+b).searchbox({height:l});$("#"+b).attr("xparent",i);$("#"+b).attr("xlabel",g);$("#"+b).attr("xid",b);myFieldStyle(b,a);}function myCheckBoxField(s,l,k,t,o,d,b,m,q){if(z!=undefined&&z!=""){z=";"+z+";";}else{var z="";}if(b<=0){b=systext.rowheight;}if(l==""){l="main";}if(t==0&&k!=""){myFieldLabel(s,l,k,t,o,d+2,0,0);o=1*(o+syslabel.fontsize+syslabel.topmargin+2);t=0;}else{myFieldLabel(s,l,k,t,o,d,0,0);}var B=q.split(";");var p=0;var A=1;var x=0;var v=0;var a="";for(var y=1;y<=B.length;y++){var f=B[y-1].lastIndexOf("[");var e=B[y-1].lastIndexOf("]");var g="c";var u=0;var n="";if(e>f&&f>=0){n=B[y-1].substr(e+1);var g=B[y-1].substr(f+1,1);if(g=="u"||g=="c"){u=B[y-1].substring(f+2,e);}else{u=B[y-1].substring(f+1,e);}if(u==""){u="0";}}else{n=B[y-1];}if(g=="u"){var g=false;}else{var g=true;}a+=";"+n;if(y==1&&B.length==1){var h=s;}else{h=s+y;}if(u==0){u=n.length*syslabel.fontsize+32;}var w='<div id="'+h+'_div"><input type="checkbox" id="'+h+'" />'+n+"</div>";$("#"+l).append($(w));$("#"+h+"_div").css(myTextCss(l,o+v,d+t+1*x,0,u));$("#"+h).prop("checked",g);$("#"+h).attr("xparent",l);$("#"+h).attr("xlabel",k);$("#"+h).attr("type","checkboxitem");$("#"+h).attr("xtype","checkboxitem");$("#"+h).attr("xtext",n);$("#"+h).attr("xid",h);if(y==1&&B.length==1){$("#"+h).attr("xgroupid","");}else{$("#"+h).attr("xgroupid",s);}if(A>=m){x=0;A=1;v+=b;}else{x+=1*u;A++;}}if(B.length>1){$("#"+l).append("<input hidden='true' type='hidden' id='"+s+"' />");$("#"+s).val(a.substr(1));$("#"+s).attr("type","checkboxgroup");$("#"+s).attr("xparent",l);$("#"+s).attr("xlabel",k);$("#"+s).attr("xid",s);}$("#"+s).attr("xitemcount",B.length);for(var y=1;y<=B.length;y++){if(y==1&&B.length==1){var h=s;}else{h=s+y;}$("#"+h).on("change",function(c){myCheckBoxChange(s,a.substr(1));});}}function myComboField(id,parent,label,labelwidth,top,left,height,width,items,value,style){if(style!=undefined&&style!=""){style=";"+style+";";}else{var style="";}if(height==0){height=systext.height;}if(parent==""){parent="main";}if(labelwidth==0&&label!=""){myFieldLabel(id,parent,label,labelwidth,top,left+2,height,width);top=1*(top+syslabel.fontsize+syslabel.topmargin+2);labelwidth=0;}else{myFieldLabel(id,parent,label,labelwidth,top,left,height,width);}var str="var "+id+"source =[";var tmp=items.split(";");for(var i=0;i<tmp.length;i++){if(i>0){str+=",";}str+='{"'+id+'":"'+tmp[i]+'","sysid":"'+i+'"}';}str+="];";eval(str);str='<div style="margin:0;" id="'+id+'_div" ><input ';if(value!=undefined&&value!=""){str+=' value="'+value+'"';}str+=' class="easyui-combobox" id="'+id+'" style="padding:0px 6px 0px 6px;" /></div>';$("#"+parent).append($(str));$("#"+id+"_div").css(myTextCss(parent,top,1*(left+labelwidth),height,width));$("#"+id).css({width:width,height:height});$("#"+id).combobox({data:eval(id+"source"),valueField:id,textField:id,formatter:function(row){return'<div align="left" style="padding:2px 0px 0px 4px;">'+eval("row."+id)+"</div>";}});if(style.indexOf("readonly")>=0){$("#"+id).combobox({"readonly":true});}if(style.indexOf("autodrop")>=0){$("#"+id).combobox({"editable":false});}if(tmp.length<=12){$("#"+id).combobox({panelHeight:"auto"});}else{$("#"+id).combobox({panelHeight:12*(syslabel.fontsize+8)});}$("#"+id).attr("type","combobox");$("#"+id).attr("xparent",parent);$("#"+id).attr("xlabel",label);$("#"+id).attr("xid",id);$("#"+id).combobox({onSelect:function(record){if(record){$("#"+id).attr("xrecord",JSON.stringify(record));$("#"+id).attr("xindex",record.sysrowno-1);}else{$("#"+id).attr("xrecord","{}");$("#"+id).attr("xindex",-1);}if(style.indexOf(";fnselect;")>=0){fnonSelectCombo(id,record);}$("#"+id).next("span").find("input").focus();}});if(style.indexOf(";checkbox;")>=0){$("#"+id).combobox({formatter:function(row){var s='<input type="checkbox" class="combobox-checkbox">'+eval("row."+id);return s;},multiple:true,editable:false,separator:";",onLoadSuccess:function(){var opts=$(this).combobox("options");var target=this;var values=$(target).combobox("getValues");$.map(values,function(value){var el=opts.finder.getEl(target,value);el.find("input.combobox-checkbox")._propAttr("checked",true);});},onSelect:function(row){var opts=$(this).combobox("options");var el=opts.finder.getEl(this,row[opts.valueField]);el.find("input.combobox-checkbox")._propAttr("checked",true);},onUnselect:function(row){var opts=$(this).combobox("options");var el=opts.finder.getEl(this,row[opts.valueField]);el.find("input.combobox-checkbox")._propAttr("checked",false);}});}if(value==undefined||value==""){$("#"+id).combobox("select",eval(id+"source[0]."+id));}}function myGetSelectedComboIndex(field){var index=[];var xvalue=$("#"+field).combobox("getValues");var xdata=$("#"+field).combobox("getData");for(var i=0;i<xvalue.length;i++){for(var j=0;j<xdata.length;j++){if(xvalue[i]==eval("xdata["+j+"]."+field)){index.push(j);break;}}}return index;}function myDBComboTreeField(i,e,d,k,g,c,h,m,s,u,q,t){if(h==0){h=systext.height;}if(e==""){e="main";}if(k==0&&d!=""){myFieldLabel(i,e,d,k,g,c+2,h,m);g=1*(g+syslabel.fontsize+syslabel.topmargin+2);k=0;}else{myFieldLabel(i,e,d,k,g,c,h,m);}if(t!=undefined&&t!=""){t=";"+t+";";}else{var t="";}var r="false";var p="false";var f="true";var o="false";var b=0;if(t!=""){t=";"+t+";";}if(t.indexOf(";checkbox;")>=0){r="true";}if(t.indexOf(";line;")>=0){f="true";}if(t.indexOf(";animate;")>=0){p="true";}if(t.indexOf(";edit;")>=0){o="true";}if(t.indexOf(";leafselect;")>=0){b=1;}var n='<div id="'+i+'_div"><input id="'+i+'" style="overflow:auto;" class="easyui-combotree" data-options="animate:'+p+", checkbox:"+r+", lines:"+f;if(o=="true"){n+=",onClick: function(node){ $(this).tree('beginEdit',node.target);}";}n+='" /></div>';$("#"+e).append($(n));$("#"+i+"_div").css(myTextCss(e,g,1*(c+k),h,m+20));if(h>0){$("#"+i).css({height:h});}if(m>0){$("#"+i).css({width:m});}$("#"+i).attr("xsql",s);$("#"+i).attr("xparent",e);$("#"+i).attr("xid",i);var l=myLoadComboTreeData(i,s,u,q,t);$("#"+i).combotree({valueField:i});$("#"+i).combotree({data:l});if(l.length<=12){$("#"+i).combotree({panelHeight:"auto"});}else{$("#"+i).combotree({panelHeight:12*(syslabel.fontsize+8)});}var a=$("#"+i).combotree("tree");if(l.length>0){}a.tree("collapseAll");}function myDBComboField(id,parent,label,labelwidth,top,left,height,width,sql,textfield,masterfield,style){if(style!=undefined&&style!=""){style=";"+style+";";}else{var style="";}var mid="";var mfield="";var index1=masterfield.indexOf("(");var index2=masterfield.indexOf(")");if(index1>=0&&index2>index1){mid=masterfield.substring(0,index1);mfield=masterfield.substring(index1+1,index2);}else{mid=masterfield;mfield==masterfield;}if(mid==""&&mfield!=""){mid=mfield;}if(mid!=""&&mfield==""){mfield=mid;}if(parent==""){parent="main";}if(height==0){height=systext.height;}if(labelwidth==0&&label!=""){myFieldLabel(id,parent,label,labelwidth,top,left+2,height,width);top=1*(top+syslabel.fontsize+syslabel.topmargin+2);labelwidth=0;}else{myFieldLabel(id,parent,label,labelwidth,top,left,height,width);}if(textfield==""){textfield=id;}var str='<div id="'+id+'_div"><input class="easyui-combobox" id="'+id+'" data-options="valueField:\''+id+"',textField:'"+textfield+"'\"></div>";$("#"+parent).append($(str));$("#"+id+"_div").css(myTextCss(parent,top,1*(left+labelwidth),0,width));$("#"+id).css({width:width,height:height});$("#"+id).combobox({panelHeight:"auto",valueField:id,textField:textfield,formatter:function(row){return'<div align="left" style="padding:2px 0px 0px 4px;">'+eval("row."+textfield)+"</div>";},onSelect:function(record){if(record){$("#"+id).attr("xrecord",JSON.stringify(record));$("#"+id).attr("xindex",record.sysrowno-1);}else{$("#"+id).attr("xrecord","{}");$("#"+id).attr("xindex",-1);}if(style.indexOf(";fnselect;")>=0){fnonSelectCombo(id,record);}$("#"+id).next("span").find("input").focus();}});if(style.indexOf("readonly")>=0){$("#"+id).combobox({"readonly":true});}if(style.indexOf("autodrop")>=0){$("#"+id).combobox({"editable":false});}$("#"+id).attr("xparent",parent);$("#"+id).attr("xlabel",label);$("#"+id).attr("xid",id);if(masterfield!=undefined&&masterfield!=""){$("#"+mid).combobox({onSelect:function(record){if(record){$("#"+mid).attr("xrecord",JSON.stringify(record));$("#"+mid).attr("xindex",record.sysrowno-1);var xvalue=eval("record."+mfield);var sql=$("#"+id).attr("xsql");if(xvalue!=""){sql="select * from ("+sql+") as p where "+mfield+"='"+xvalue+"'";}$("#"+id).combobox("clear");myGetComboxData(id,sql);myBindKeyDownEvent(id);}else{$("#"+mid).attr("xrecord","{}");$("#"+mid).attr("xindex",-1);}if(style.indexOf(";fnselect;")>=0){fnonSelectCombo(mid,record);}$("#"+mid).next("span").find("input").focus();mySelectOnFocus();}});}else{myGetComboxData(id,sql);}$("#"+id).attr("xsql",sql);$("#"+id).attr("type","combobox");if(mid!=""){mySelectComboByIndex(mid,0);}}function myCheckComboField(a,h,f,i,e,c,k,b,d,g){}function myImageComboField(a,h,f,i,e,c,k,b,d,g){}function myImageIcon(b){var c="download64.jpg";if(b!=""){fileext=b.substring(b.lastIndexOf(".")+1,255).toLowerCase();var e=";avi;rmvb;mov;asf;wmv;3gp;flv;mkv;rm;mid;vob;webm;";var d=";mp3;wav;wma;";var a=";jpg;jpeg;gif;pcx;png;bmp;psd;";if(fileext==undefined){fileext="";}if(fileext=="doc"||fileext=="docx"){c="word64.png";}else{if(fileext=="xls"||fileext=="xlsx"){c="excel64.png";}else{if(fileext=="ppt"||fileext=="pptx"){c="ppt64.png";}else{if(fileext=="pdf"){c="pdf64.png";}else{if(fileext=="swf"){c="swf64.png";}else{if(fileext=="fla"){c="flash64.png";}else{if(fileext=="html"||fileext=="htm"){c="html64.png";}else{if(fileext=="rar"){c="rar64.png";}else{if(fileext=="zip"){c="zip64.png";}else{if(fileext=="swf"){c="swf64.png";}else{if(fileext=="exe"){c="fileexe64.png";}else{if(a.indexOf(fileext)>=0){c="image64.png";}else{if(d.indexOf(fileext)>=0){c="audio64.png";}else{if(e.indexOf(fileext)>=0){c="video64.png";}}}}}}}}}}}}}}}return c;}function myImageField(b,h,g,i,f,d,k,c,a){var e="";if(c==0){c=300;}if(h==""){h="main";}if(k==0){k=systext.height;}if(i==0&&g!=""){myFieldLabel(b,h,g,i,f,d+2,k,c);f=1*(f+syslabel.fontsize+syslabel.topmargin+2);i=0;}else{myFieldLabel(b,h,g,i,f,d,k,c);}var e='<img src="'+a+'" id="'+b+'" style="position: absolute; top:'+f+"px; left:"+d+"px; width:"+c+"px; height:"+k+'px; padding-left:0px 0px 0px 0px; border:false" />';$("#"+h).append($(e));$("#"+b).css(myTextCss(h,f,1*(d+i),0,c));$("#"+b).attr("xparent",h);$("#"+b).attr("xlabel",g);$("#"+b).attr("xtype","image");$("#"+b).attr("type","image");$("#"+b).attr("xid",b);$("#"+b).attr("xwidth",c);$("#"+b).attr("xheight",k);if(a!=""&&k>0&&c>0){myResizeImage(b,a,k,c);}}function myResizeImage(b,e,a,c){if(a>0&&c>0){var d=new Image();d.src=e;aheight=d.height+0;awidth=d.width+0;d.onload=function(){var k=d.height+0;var i=d.width+0;if(i>0&&k>0){var f=1;var g=c/i;var h=a/k;if(g<1||h<1){f=(g<=h?g:h);}if(f!=0){i=i*f;k=k*f;}$("#"+b).css({width:i,height:k});}};return({width:awidth,height:aheight});}}function myHLine(c,h,g,e,i,d,b){if(b==undefined){var b="black";}var a="system/images/hline.gif";var f='<img src="'+a+'" id="'+c+'" style="position: absolute; top:'+g+"px; left:"+e+"px; width:"+d+"px; height:"+i+'px; padding-left:0; border:false" />';$("#"+h).append($(f));$("#"+c).css(myTextCss(h,g,e,i,d));}function myLine(b,h,g,d,i,c,a,e){if(e==undefined){var e="black";}if(a==undefined){var a="";}a=";"+a+";";if(a.indexOf(";bevel;")>=0){if(i==1){var f='<div id="'+b+'1"><table border="0" cellspacing="0" cellpadding="0" height='+i+' style="border-color:gray; border-left-style:solid; border-width:'+c+'px"><tr><td valign=top></table></div>';f+='<div id="'+b+'2"><table border="0" cellspacing="0" cellpadding="0" height='+i+' style="border-color:white; border-left-style:solid; border-width:'+c+'px"><tr><td valign=top></table></div>';$("#"+h).append($(f));$("#"+b+"1").css(myTextCss(h,g,d,i,c));$("#"+b+"2").css(myTextCss(h,g+i,d,i,c));}else{if(c==1){var f='<div id="'+b+'1"><table border="0" cellspacing="0" cellpadding="0" height='+i+' style="border-color:gray; border-left-style:solid; border-width:'+c+'px"><tr><td valign=top></table></div>';f+='<div id="'+b+'2"><table border="0" cellspacing="0" cellpadding="0" height='+i+' style="border-color:white; border-left-style:solid; border-width:'+c+'px"><tr><td valign=top></table></div>';$("#"+h).append($(f));$("#"+b+"1").css(myTextCss(h,g,d,i,c));$("#"+b+"2").css(myTextCss(h,g,d+c,i,c));}}}else{var f='<div id="'+b+'"><table border="0" cellspacing="0" cellpadding="0" height='+i+' style="border-color:'+e+"; border-left-style:solid; border-width:"+c+'px"><tr><td valign=top></table></div>';$("#"+h).append($(f));$("#"+b).css(myTextCss(h,g,d,i,c));}}function myClearFileField(b){var a=b.split(";");for(var d=0;d<a.length;d++){var e=a[d];var c=document.getElementById(e);if(c.outerHTML){c.outerHTML=c.outerHTML;}else{c.value="";}btnid=e+"button";if($("#"+btnid).length>0){$("#"+btnid).linkbutton("disable");}}}function myFileFieldChange(b){var a=b.split(";");for(var c=0;c<a.length;c++){var e=a[c];var d=e+"button";if($("#"+d).length>0){$("#"+e).bind("change",function(g){var f=$("#"+e).val();if(f==""){$("#"+d).linkbutton("disable");}else{$("#"+d).linkbutton("enable");}});}}}function myAddAttachment(c,b){var a=myImageIcon($("#"+c).attr("xsourcefile"));for(var e=1;e<=sys.maxfilenumber;e++){if($("#filediv"+e).length==0){break;}}myHiddenFields("filesizedesc"+e+";filesourcename"+e+";fileosname"+e+";filesize"+e+";fileext"+e+";uploaddate"+e);mySetValue("filesizedesc"+e,$("#"+c).attr("xfilesizedesc"));mySetValue("filesourcename"+e,$("#"+c).attr("xsourcefile"));mySetValue("fileosname"+e,$("#"+c).attr("xfileosname"));mySetValue("filesize"+e,$("#"+c).attr("xfilesize"));mySetValue("fileext"+e,$("#"+c).attr("xfileext"));mySetValue("uploaddate"+e,mySysDateTime("datetime"));mySetValue("downloadtimes"+e,"0");$("#filediv"+(e)).remove();var d="";d+='<div id="filediv'+(e)+'" style="width:220px; display:block; float:left; margin:4px 0px 0px 4px;"></div>';$("#"+b).append($(d));d='<div><a href="javascript:myDeleteAttachment('+e+');"><img src="system/images/deletefile.png" height="16px" width="16px" /></a><center><img src="system/images/'+a+'" height="64px" width="64px" /></div>';d+='<div style="text-align:center; width:100%; margin:4px 0px 4px 0px;" >'+myGetValue("filesourcename"+e)+"</div>";d+='<div style="text-align:center;" >文件大小：'+myGetValue("filesizedesc"+e)+"</div>";d+="</center>";$("#filediv"+e).append($(d));}function myShowAttachment(a,c){for(var e=1;e<=sys.maxfilenumber;e++){$("#filediv"+e).remove();mySetValue("fileosname"+e,"");}for(var e=1;e<=a.length;e++){var b=myImageIcon(a[e-1].filesourcename);myHiddenFields("filesizedesc"+e+";filesourcename"+e+";fileosname"+e+";filesize"+e+";fileext"+e+";downloadtimes"+e+";uploaddate"+e);mySetValue("filesizedesc"+e,a[e-1].filesizedesc);mySetValue("filesourcename"+e,a[e-1].filesourcename);mySetValue("fileosname"+e,a[e-1].fileosname);mySetValue("filesize"+e,a[e-1].filesize);mySetValue("fileext"+e,a[e-1].fileext);mySetValue("uploaddate"+e,a[e-1].uploaddate);mySetValue("downloadtimes"+e,a[e-1].downloadtimes);var d="";d+='<div id="filediv'+e+'" style="width:220px; display:block; float:left; margin:4px 0px 0px 4px;"></div>';$("#"+c).append($(d));d='<div><a href="javascript:myDeleteAttachment('+e+');"><img src="system/images/deletefile.png" height="16px" width="16px" /></a><center><img src="system/images/'+b+'" height="72px" width="72px" /></div>';d+='<div style="text-align:center; width:100%; margin:4px 0px 4px 0px;" >'+myGetValue("filesourcename"+e)+"</div>";d+='<div style="text-align:center;" >文件大小：'+myGetValue("filesizedesc"+e)+"</div>";d+="</center>";$("#filediv"+e).append($(d));}}function myDownLoadAttachment(a,c){for(var e=1;e<=sys.maxfilenumber;e++){$("#filediv"+e).remove();mySetValue("fileosname"+e,"");}for(var e=1;e<=a.length;e++){var b=myImageIcon(a[e-1].filesourcename);myHiddenFields("filesizedesc"+e+";filesourcename"+e+";fileosname"+e+";filesize"+e+";fileext"+e+";downloadtimes"+e+";uploaddate"+e);mySetValue("filesizedesc"+e,a[e-1].filesizedesc);mySetValue("filesourcename"+e,a[e-1].filesourcename);mySetValue("fileosname"+e,a[e-1].fileosname);mySetValue("filesize"+e,a[e-1].filesize);mySetValue("fileext"+e,a[e-1].fileext);mySetValue("uploaddate"+e,a[e-1].uploaddate);mySetValue("downloadtimes"+e,a[e-1].downloadtimes);var d="";d+='<div id="filediv'+e+'" style="width:220px; display:block; float:left; margin:4px 0px 0px 4px;"></div>';$("#"+c).append($(d));d='<div><a href="javascript:myDownLoadFile('+e+');"><center><img src="system/images/'+b+'" height="72px" width="72px" /></div>';d+='<div style="text-align:center; width:100%; margin:4px 0px 4px 0px;" >'+myGetValue("filesourcename"+e)+"</div>";d+='<div style="text-align:center;" >文件大小：'+myGetValue("filesizedesc"+e)+"</div>";d+="</center></a>";$("#filediv"+e).append($(d));}}function myDeleteAttachment(a){$("#filediv"+a).remove();$("#fileosname"+a).val("");}function myFileField(d,p,n,f,q,e,k){var g=d+"button";var c=d+"bar";var h=d+"window";var m="";if(e==0){e=300;}if(p==""){p="main";}if(q==0){q=systext.height;}var l=f+4;var b=n+q+4;var i=n;var o=f;if(k=="right"){e=e-75;var l=f+e+9;var b=n-2;}else{if(k=="left"){var l=f;var b=n-2;f=f+75;e=e-75;}}var m='<input type="file" id="'+d+'" style="position: absolute; top:'+n+"px; left:"+f+"px; width:"+e+"px; height:"+q+'px; padding-left: 4px;" />\n';$("#"+p).append($(m));$("#"+d).css(myTextCss(p,n,f,0,e));myWindow(h,"正在上传",0,0,70,320,"","");m="<div class='easyui-progressbar' id='"+c+"'></div>";$("#"+h).append($(m));$("#"+c).css(myTextCss(h,4,2,24,300));$("#"+c).progressbar();if(k!="none"){myButton(g,p,"上传",b,l,26,68,"uploadIcon","","");var a=$("#"+d).val();if(a==""){$("#"+g).linkbutton("disable");}else{$("#"+g).linkbutton("enable");}$("#"+d).bind("change",function(s){var r=$("#"+d).val();if(r==""){$("#"+g).linkbutton("disable");}else{$("#"+g).linkbutton("enable");}});$("#"+g).bind("click",function(r){});}$("#"+d).attr("xparent",p);$("#"+d).attr("xlabel","");$("#"+d).attr("xid",d);$("#"+d).attr("xsourcefile","");$("#"+d).attr("xfileosname","");$("#"+d).attr("xtargetfile","");$("#"+d).attr("xfilesize",0);$("#"+d).attr("xfilesizedesc","");$("#"+d).attr("xtargetpath","");$("#"+d).attr("xfileext","");}function myFileupLoad(e,o,b,l){if(l==undefined){var l="";}var k={};var h=e+"button";var i=e+"window";var c=e+"bar";var a=$("#"+e).val();var n=a.substring(a.lastIndexOf(".")+1,255).toLowerCase();if(l!=""&&(";"+l+";").indexOf(";"+n+";")<0){k={"error":"文件类型错误，上传失败！"};var f=l.replaceAll(";",",");myMessage("文件扩展名限于："+f+"@n文件类型错误，上传失败！","info");myClearFileField(e);myFileFieldChange(e);}else{$("#"+i).window("open");$("#"+c).progressbar("setValue",0);var g=document.getElementById(e).files[0];var d=new FormData();d.append("file",g);var m=new XMLHttpRequest();m.open("post","system//easyui_fileUpLoad.jsp?targetname="+b+"&targetpath="+o,true);m.onload=function(){if(m.status==200){k=JSON.parse(m.responseText);$("#"+e).attr("xerror",k.error);if(k.error==""){$("#"+e).attr("xfilesize",k.filesize);$("#"+e).attr("xfilesizedesc",k.filesizedesc);$("#"+e).attr("xfileosname",k.fileosname);$("#"+e).attr("xsourcefile",k.sourcefile);$("#"+e).attr("xtargetfile",k.targetfile);$("#"+e).attr("xtargetpath",k.targetpath);$("#"+e).attr("xfileext",k.fileext);myMessageShow("文件已经上传成功！");$("#"+h).linkbutton("disable");}else{myMessage("文件上传失败！","error");}$("#"+i).window("close");myClearFileField(e);myFileFieldChange(e);myFileEvents(e,"upload");}};m.upload.onprogress=function(p){loaded=p.loaded;tot=p.total;per=Math.floor(100*loaded/tot);$("#"+e+"bar").progressbar("setValue",per);};m.send(d);}return k;}function myEditorField(a,h,f,i,e,c,k,b,g){var d="";if(h==""){h="main";}if(k==0){k=systext.height;}if(i==0&&f!=""){myFieldLabel(a,h,f,i,e,c+2,k,b);e=1*(e+syslabel.fontsize+syslabel.topmargin+2);i=0;}else{myFieldLabel(a,h,f,i,e,c,k,b);}$("#"+h).append("<div id='"+a+"_div'><textarea id='"+a+"'></textarea></div>");$("#"+a+"_div").css(myTextCss(h,e,1*(c+i),k,b));if(k>0){$("#"+a).jqxEditor({height:k});}else{$("#"+a).jqxEditor({height:"100%"});}if(b>0){$("#"+a).jqxEditor({width:b});}else{$("#"+a).jqxEditor({width:"100%"});}$("#"+a).jqxEditor(sys.theme);if(g!=undefined&&g!=""){$("#"+a).val(g);}$("#"+a).jqxEditor({localization:{"bold":"加粗","italic":"斜体","underline":"下划线","format":"格式","font":"字体","size":"字体大小","color":"字体颜色","background":"背景颜色","left":"左对齐","center":"居中","right":"右对齐","outdent":"文字左移","indent":"文字右移","ul":"分段","ol":"分级","image":"插入图片","link":"插入链接","html":"html语言","clean":"格式化"}});}function myHref(c,h,g,f,e,i,d,b,a){myhref(c,h,g,f,e,i,d,b,a);}function myhref(c,k,i,h,e,l,d,b,a){if(a!=undefined){a=";"+a+";";}else{var a="";}var f="";if(b==""){b="#";}if(a.indexOf(";blank;")>=0){f="_blank";}var g='<div id="'+c+'_div" style="position:absolute">';if(a.indexOf(";[")>=0){g+="【";}g+='<a id="'+c+'" href="'+b+'" target="'+f+'" >'+i+"</a>";if(a.indexOf("];")>=0){g+="】";}g+="</div>";$("#"+k).append($(g));$("#"+c+"_div").css(myTextCss(k,h,e,l,d));$("#"+c+"_div").css({"font-size":syslabel.fontsize});}function myDBTree(i){var g="";if(i.parent==""){i.parent="main";}var c="false";var e="false";var f="false";var b="false";if(i.checkbox){c="true";}if(i.line){f="true";}if(i.animate){e="true";}if(i.editable){b="true";}g+='<div id="'+i.id+'" style="overflow:auto;" class="easyui-tree" data-options="animate:'+e+", checkbox:"+c+", lines:"+f;if(b=="true"){g+=",onClick: function(node){ $(this).tree('beginEdit',node.target);}";}g+='"></div>';$("#"+i.parent).append($(g));var d=$("#"+i.parent).height()*1;var k=$("#"+i.parent).width()*1;if(i.height>0){$("#"+id).css({height:i.height});}else{$("#"+i.id).css({height:"100%"});}if(i.width>0){$("#"+i.id).css({width:i.width});}else{$("#"+i.id).css({width:"100%"});}$("#"+i.id).attr("xsql",i.sql);$("#"+i.id).attr("xtype","tree");$("#"+i.id).attr("xparent",i.parent);$("#"+i.id).attr("xtitle",i.title);$("#"+i.id).attr("xid",i.id);var a=myLoadTreeData(i);$("#"+i.id).tree({data:a});$("#"+i.id).tree("collapseAll");$("#"+i.id).tree({onDblClick:function(h){if(h.state=="closed"){$(this).tree("expand",h.target);}else{$(this).tree("collapse",h.target);}myTreeEvents(i.id,"ondblclick",h);},onSelect:function(h){i.selectednode=h;myTreeEvents(i.id,"onselect",h);}});var l=$("#"+i.id).tree("getRoot");if(l!=null){if(l.children){$("#"+i.id).tree("expand",l.target);}$("#"+i.id).tree("select",l.target);}return i;}function myLoadTreeData(pmyTree1){if(pmyTree1.style!="full"){$("#"+pmyTree1.id).tree({onBeforeExpand:function(node){var pid=node.id;var child_node=$("#"+pmyTree1.id).tree("getChildren",node.target);if(child_node.length==1&&child_node[0].id=="_"+pid){if(pmyTree1.sql!=""){xsql="select * from ("+pmyTree1.sql+") as p where parentnodeid='"+pid+"'";}else{xsql="";}$.ajax({url:"system//easyui_getChildNodes.jsp",data:{database:sysdatabasestring,selectsql:xsql,keyfield:pmyTree1.keyfield,sortfield:pmyTree1.sortfield,style:pmyTree1.style},async:false,method:"post",success:function(data){var source=eval(data);$("#"+pmyTree1.id).tree("remove",child_node[0].target);$("#"+pmyTree1.id).tree("append",{parent:node.target,data:source});}});}myTreeEvents(pmyTree1.id,"onBeforeExpand",node);}});}var source=[];if(pmyTree1.style=="full"){$.ajax({url:"system//easyui_getAllTreeNodes.jsp",data:{database:sysdatabasestring,selectsql:pmyTree1.sql,keyfield:pmyTree1.keyfield,sortfield:pmyTree1.sortfield},async:false,method:"post",success:function(data){source=eval(data);}});}else{if(pmyTree1.sql!=""){xsql="select * from ("+pmyTree1.sql+") as p where parentnodeid=''";}else{xsql="";}$.ajax({url:"system//easyui_getChildNodes.jsp",data:{database:sysdatabasestring,selectsql:xsql,keyfield:pmyTree1.keyfield,sortfield:pmyTree1.sortfield,style:pmyTree1.style},async:false,method:"post",success:function(data){source=eval(data);}});}return source;}function myLoadComboTreeData(id,sql,keyfield,sortfield,style){if((";"+style+";").indexOf(";full;")<0){$("#"+id).combotree({onBeforeExpand:function(node){var pid=eval("node."+keyfield);var xcbtree=$("#"+id).combotree("tree");var child_node=xcbtree.tree("getChildren",node.target);if(child_node.length==1&&child_node[0].id=="_"+pid){if(sql!=""){xsql="select * from ("+sql+") as p where parentnodeid='"+pid+"'";}else{xsql="";}$.ajax({url:"system/easyui_getChildNodes.jsp",data:{database:sysdatabasestring,selectsql:xsql,keyfield:keyfield,sortfield:""},async:false,method:"post",success:function(data){var source=eval(data);xcbtree.tree("remove",child_node[0].target);xcbtree.tree("append",{parent:node.target,data:source});}});}}});}var source=[];if((";"+style+";").indexOf(";full;")>=0){$.ajax({url:"system/easyui_getAllTreeNodes.jsp",data:{database:sysdatabasestring,selectsql:sql,keyfield:keyfield,sortfield:sortfield},async:false,method:"post",success:function(data){source=eval(data);}});}else{if(sql!=""){xsql="select * from ("+sql+") as p where parentnodeid=''";}else{xsql="";}$.ajax({url:"system/easyui_getChildNodes.jsp",data:{database:sysdatabasestring,selectsql:xsql,keyfield:keyfield,sortfield:sortfield,style:style},async:false,method:"post",success:function(data){source=eval(data);}});}return source;}function myFieldset(a,h,g,f,c,i,b){if(h==""){h="main";}var e="";e='<fieldset id="'+a+'" style="position: absolute; margin:0; padding:0; border:1px solid #B5B8C8;">';if(g!=""){e+='<legend style="margin:0 10px; padding:0;">'+g+"</legend>";}e+="</fieldset>";$("#"+h).append($(e));var d={margin:"0",padding:"0",position:"absolute",top:f+"px",left:c+"px",width:b,height:i,"z-index":2};$("#"+a).css(d);$("#"+a).css(sys.theme);$("#"+a).attr("type","fieldset");$("#"+a).attr("xparent",h);$("#"+a).attr("xtitle",g);$("#"+a).attr("xid",a);}function myGroupbox(h,d,f,e,a,c,b){var g="";if(b==1){xborder=true;}else{xborder=false;}g='<div id="'+h+'" style="position:absolute; top:'+f+"px; left:"+e+"px; padding:0px 0;border:"+xborder+' ">';g+="</div>";if(d!=""){$("#"+d).append($(g));$("#"+h+"").css(myTextCss(d,f,e,a,c));$("#"+h).attr("xparent",d);$("#"+h).attr("xid",h);}return g;}function myPanel(h,d,g,f,e,a,c,b){if(d==""){d="main";}str='<div class="easyui-panel" id="'+h+'" title="&nbsp;'+g+'" style="position:relative; background:#fafafa; margin:0px 0px 0px 0px; padding:2px 2px 2px 2px;';if(c>0){str+="width:"+c+"px;";}else{str+="width: 100%;";}if(a>0){str+="height:"+a+"px;";}else{str+="height: 100%;";}str+='"\n';str+='data-options="border:false';if(a==0&&c==0){str+=",fit:true";}str+="";if(b.indexOf("border")>=0){str+=",border:true";}else{str+=",border:false";}if(b.indexOf("close")>=0){str+=",closable:true";}if(b.indexOf("min")>=0){str+=",minimizable:true";}if(b.indexOf("min")>=0){str+=",maximizable:true";}if(b.indexOf("collapse")>=0){str+=",collapsible:true";}str+='" >';str+="</div>";$("#"+d).append($(str));$("#"+h).panel();$("#"+h).attr("xparent",d);$("#"+h).attr("xid",h);$("#"+h).attr("xtitle",g);}function mySplitButton(id,parent,text,top,left,height,width,icon,style,event){if(parent==""){parent="main";}if(width==0){height=sysbutton.width;}if(height==0){height=sysbutton.height;}if(style!=""){style=";"+style+";";}var str="";if(style!=undefined&&style.indexOf(";menu;")>=0){var menuflag=true;}else{var menuflag=false;}if(style!=undefined&&style.indexOf(";btnsep;")>=0){str+='<a href="javascript:void(0)" id="'+id+'_sep" class="btn-separator"></a>';}str+='<a href="javascript:void(0)" id="'+id+'" class="easyui-splitbutton" style="padding:0; margin:0;"></a>';$("#"+parent).append($(str));$("#"+id).css(myTextCss(parent,top,left,height,width));$("#"+id).attr("xparent",parent);$("#"+id).attr("xid",id);if(icon!=""){$("#"+id).splitbutton({"iconCls":icon,iconAlign:"left"});}if(text!=""){$("#"+id).splitbutton({"text":text});}if(style!=undefined&&style.indexOf(";plain;")>=0){$("#"+id).splitbutton({"plain":true});}if(event!=undefined&&event!=""){$("#"+id).bind("click",function(e){eval(event+"(e);");});}}function myButton(id,parent,text,top,left,height,width,icon,style,event){if(parent==""){parent="main";}if(width==0){height=sysbutton.width;}if(height==0){height=sysbutton.height;}if(style!=""){style=";"+style+";";}var str="";if(style!=undefined&&style.indexOf(";menu;")>=0){var menuflag=true;}else{var menuflag=false;}if(style!=undefined&&style.indexOf(";btnsep;")>=0){str+='<a href="javascript:void(0)" id="'+id+'_sep" class="btn-separator"></a>';}if(menuflag){str+='<a href="javascript:void(0)" id="'+id+'" class="easyui-menubutton" style="padding:0; margin:0;"></a>';}else{str+='<a href="javascript:void(0)" id="'+id+'" class="easyui-linkbutton" style="padding:0; margin:0;"></a>';}$("#"+parent).append($(str));$("#"+id).css(myTextCss(parent,top,left,height,width));$("#"+id).attr("xparent",parent);$("#"+id).attr("xid",id);$("#"+id).attr("xtype","linkbutton");if(icon!=""){if(menuflag){$("#"+id).menubutton({"iconCls":icon,iconAlign:"left"});}else{$("#"+id).linkbutton({"iconCls":icon,iconAlign:"left"});}}if(text!=""){if(menuflag){$("#"+id).menubutton({"text":text});}else{$("#"+id).linkbutton({"text":text});}}if(style!=undefined&&style.indexOf(";plain;")>=0){if(menuflag){$("#"+id).menubutton({plain:true});}else{$("#"+id).linkbutton({plain:true});}}else{if(menuflag){$("#"+id).menubutton({plain:false});}else{$("#"+id).linkbutton({plain:false});}}if(event!=undefined&&event!=""){$("#"+id).bind("click",function(e){eval(event+"(e);");});}}function myToolbar(g,d,e,a,c,b){if(b==undefined||b==""){var b="#E0ECFF";}if(a==0){xheight=sysbutton.height+2;}var f='<div id="'+g+'_div" class="easyui-panel" style="padding:1px 6px 1px 8px; height:'+xheight+"px; position:relative; ";if(b!=""){f+=" background:"+b+"; ";}f+=' border-bottom:1px solid #B5B8C8;"></div>';$("#"+d).append($(f));myButtonGroup(g,g+"_div",e,a,c);}function myButtonGroup(a,o,m,q,b){if(o==""){o="main";}if(b==0){b=65;}var f=m.split(";");var e=1;for(var g=0;g<f.length;g++){var h=f[g].split("/");var d="";var n="";var p="";var c="";if(h.length>=1){p=h[0];if(h.length>=2){d=h[1];}if(h.length>=3){n=h[2];}if(h.length>=4){c=h[3];}if(p=="-"||h.length==1){var l='<span style="padding:3px 0;"><a id="'+a+"_sep"+e+'" href="javascript:void(0)" class="btn-separator" style="';if(q>0){l+="height:"+q+"px;";}l+='"></a></span>';$("#"+o).append($(l));e++;}else{if(c==""){var l='<a href="javascript:void(0)" id="'+d+'" class="easyui-linkbutton" data-options="plain:true';}else{var l='<a href="javascript:void(0)" id="'+d+'" class="easyui-menubutton" data-options="plain:true, menu:\'#'+c+"'";}if(n!=""){l+=",iconCls:'"+n+"'";}if(q>0){l+="height:"+q+"px;";}l+='">'+p+"</a>";$("#"+o).append($(l));if(c==""){$("#"+d).linkbutton({width:b});$("#"+d).attr("xtype","linkbutton");}else{$("#"+d).menubutton({width:b+20});$("#"+d).attr("xtype","menubutton");}}}}}function mySep(f,b,d,c,a){if(b==""){b="main";}if(a!=""){a=";"+a+";";}var e="";if(a!=undefined&&a.indexOf(";menu;")>=0){e+='<div id="'+f+'_div"><a href="javascript:void(0)" id="'+f+'_sep" class="menu-sep"></a></div>';}else{e+='<div style="margin:2px 0;" id="'+f+'_div"><a href="javascript:void(0)" id="'+f+'_sep" class="btn-separator" style="margin:'+d+'px 0;" ></a></div>';}$("#"+b).append($(e));$("#"+f+"_div").css(myTextCss(b,d,c,0,0));}function myForm(b,h,g,f,d,k,c,a){if(h==""){h="main";}if(h=="main"&&(c<=0||k<=0)){$("#main").removeClass();$("#main").addClass("easyui-layout");$("#main").panel({"fit":true});}str='<div class="easyui-panel" id="'+b+'" title="&nbsp;'+g+'" style="position:relative; background:#fafafa; margin:0; padding:0px 0px 0px 0px;';var e=$("#"+h).height()-2;var i=$("#"+h).width()-2;if(c>0){str+="width:"+c+"px;";}else{str+="width: auto;";}if(k>0){str+="height:"+k+"px;";}else{str+="height: auto;";}if(d>0){str+="left:"+d+"px;";}if(f>0){str+="top:"+f+"px;";}str+='"\n';str+="data-options=\"iconCls:'panelIcon'";if(k==0&&c==0){str+=",fit:true";}if(a.indexOf("close")>=0){str+=",closable:true";}if(a.indexOf("collapse")>=0){str+=",collapsible:true";}if(a.indexOf("min")>=0){str+=",minimizable:true";}if(a.indexOf("min")>=0){str+=",maximizable:true";}str+='" >';str+="</div>\n";$("#"+h).append($(str));$("#"+b).panel();$("#"+b).attr("xparent",h);$("#"+b).attr("xid",b);$("#"+b).attr("xtitle",g);}function myTabs(b,o,l,n,f,p,c,a){if(o==""){o="main";}var e=b+"Panel";if(a.indexOf("close")>=0){var k=true;}else{k=false;}var m='<div id="'+b+'" class="easyui-tabs" style="overflow: auto; ';if(n>0){m+="margin: "+n+"px 0px -19px ";}else{m+="margin: 0px 0px -19px ";}if(f>0){m+=f+'px; padding:0px 0px 0px 0px;">\n';}else{m+='0px; padding:0px 0px 0px 0px;">\n';}var h=l.split(";");for(var g=0;g<h.length;g++){m+='<div id="'+b+(g+1)*1+'" title="'+h[g]+'" data-options="closable:'+k+'" style="top:0px; left:0px; position:relative; overflow:auto;">\n';m+="</div>\n";}m+="</div>\n";$("#"+o).append($(m));$("#"+b).attr("xparent",o);$("#"+b).attr("xid",b);$("#"+b).attr("type","tabs");$("#"+b).tabs();if(c<=0&&p<=0){$("#"+b).tabs({fit:true});}else{if(c<=0&&$("#"+o).length>0){c=$("#"+o).width()-0;}if(p<=0&&$("#"+o).length>0){p=$("#"+o).height()-0;}$("#"+b).tabs({width:c,height:p});}$("#"+o).attr("xtab",b);if(h.length>0){for(var g=1;g<h.length;g++){$("#"+b).tabs("select",g);}$("#"+b).tabs("select",0);}var d=$("#"+b).tabs("getTab",0);$("#"+b).tabs("update",{tab:d,options:{}});}function myTabForm(b,i,h,g,f,e,k,c,a){var d=b+"Form";myForm(d,i,h,f,e,k,c,a);myTabs(b,d,g,0,0,0,0,a);}function myMenuButton(a,h,g,f,c,i,b,e){var d='<a href="javascript:void(0)" id="'+a+'" class="easyui-menubutton" data-options="plain:true, menu:\'#'+e+'\'" style="';if(b>0){d+="width:"+b+"px";}if(i>0){d+="height:"+i+"px";}if(f>0&&c>0){d+="position:absolute; top:"+f+"px; left:"+c+"px;";}d+='">'+g+"</a>";$("#"+h).append($(d));$("#"+a).attr("xtype","menubutton");$("#"+a).menubutton();}function myMenu(f,b,a){myMenuItem(f,b);var d=a.split(";");if(d.length>0){var e="";for(var c=0;c<d.length;c++){if(c>0){e+=",";}e+="#"+d[c];}}}function myMenuItem(g,b){var f="";if($("#"+g).length==0){f='<div id="'+g+'" xtype="menu" class="easyui-menu" data-options="" style="width:auto"></div>';$("#main").append($(f));}$("#"+g).menu();var a=1;f="";var d=b.split(";");for(var c=1;c<=d.length;c++){var e=d[c-1].split("/");if(e.length==1&&e[0]=="-"){$("#"+g).menu("appendItem",{id:g+"_sep"+a,separator:true});a++;}else{if(e.length==2){$("#"+g).menu("appendItem",{xtype:"menuitem",text:e[0],id:e[1]});$("#"+e[1]).attr("xtype","menuitem");$("#"+e[1]).attr("xparent",g);}else{if(e.length==3){$("#"+g).menu("appendItem",{xtype:"menuitem",text:e[0],id:e[1],iconCls:e[2]});$("#"+e[1]).attr("xtype","menuitem");$("#"+e[1]).attr("xparent",g);}}}}}function myWinTitle(a,b){$("#"+a).window("setTitle","<div style='margin:0px 0px 0px 4px; '>"+b+"</div>");}function myWindow(id,title,top,left,height,width,buttons,style){if(style==undefined){var style="";}var xid=id+"Form";var str='<div id="'+id+'" class="easyui-window" title="<div style=\'margin:0px 0px 0px 4px; \'>'+title+'" data-options="iconCls:\'panelIcon\'" ';str+='style="';if(style.indexOf(";scrollbar;")>=0){str+="overflow:auto;";}else{str+="overflow:hidden;";}str+='position:relative; margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;"></div>';$("#main").append($(str));if(width<=0){width=500;}if(height<=0){height=400;}var xstyle="({width:"+width+", height:"+height;if(style==undefined||style==""){style="close";}if(buttons==undefined){buttons="";}style=";"+style+";";if(style.indexOf(";resize;")>=0){xstyle+=" ,resizable: true";}else{xstyle+=" ,resizable: false";}if(style.indexOf(";drag;")>=0){xstyle+=" ,draggable: true";}else{xstyle+=" ,draggable: false";}if(style.indexOf(";close;")>=0){xstyle+=" ,closable:true";}else{xstyle+=" ,closable:false";}if(style.indexOf(";collapse;")>=0){xstyle+=" ,collapsible:true";}else{xstyle+=" ,collapsible:false";}if(style.indexOf(";max;")>=0){xstyle+=" ,maximizable:true";}else{xstyle+=" ,maximizable:false";}if(style.indexOf(";min;")>=0){xstyle+=" ,minimizable:true";}else{xstyle+=" ,minimizable:false";}if(style.indexOf(";modal;")>=0){xstyle+=" ,modal:true";}else{xstyle+=" ,modal:false";}xstyle+="})";if(top>0&&left>0){$("#"+id).window({left:left,top:top});}$("#"+id).window(eval(xstyle));$("#"+id).attr("type","window");$("#"+id).window("close");if(buttons!=undefined&&buttons!=""){buttons=";"+buttons+";";var btntop=height-74;var btnleft=width-sysbutton.width-30;if(buttons.indexOf(";cancel;")>=0){myButton(id+"CancelBtn",id,"取消",btntop,btnleft,sysbutton.height,sysbutton.width,"","");btnleft=btnleft-sysbutton.width-1;}if(buttons.indexOf(";close;")>=0){myButton(id+"CloseBtn",id,"关闭",btntop,btnleft,sysbutton.height,sysbutton.width,"","");btnleft=btnleft-sysbutton.width;$("#"+id+"CancelBtn").on("click",function(){$("#"+id).window("close");});}if(buttons.indexOf(";save;")>=0){myButton(id+"SaveBtn",id,"保存",btntop,btnleft,sysbutton.height,sysbutton.width,"","");btnleft=btnleft-sysbutton.width;}if(buttons.indexOf(";ok;")>=0){myButton(id+"OkBtn",id,"确定",btntop,btnleft,sysbutton.height,sysbutton.width,"","");btnleft=btnleft-sysbutton.width;}}}function myGridColumns(fieldset){var xcolumns=[];for(var i=0;i<=255;i++){xcolumns[i]={};xcolumns[i].name="";xcolumns[i].title="";xcolumns[i].align="";xcolumns[i].type="c";xcolumns[i].length="100";xcolumns[i].dec="0";xcolumns[i].fixed=0;}var result=[];var xfields=fieldset.split(";");for(var i=0;i<xfields.length;i++){var s=xfields[i].toLowerCase();var p1=s.indexOf("[");var p2=s.indexOf("]");if(p1>=0&&p2>p1){var ss=s.substring(p1+1,p2);var x1=ss.indexOf("@");if(x1>=0){xcolumns[i].align=ss.substr(x1+1,1);ss=ss.replace("@"+xcolumns[i].align,"");}var x2=ss.indexOf("%");if(x2>=0){xcolumns[i].type=ss.substr(x2+1,1);ss=ss.replace("%"+xcolumns[i].type,"");}var x3=ss.indexOf("#");var s1="";var s2="";if(x3>=0){s1=ss.substring(x3+1,255);}else{s1=ss;}var x4=s1.indexOf(",");if(x4<0){xcolumns[i].length=s1;}else{xcolumns[i].length=s1.substring(0,x4);xcolumns[i].dec=s1.substr(x4+1,2);}s=s.substring(p2+1,255);}var x1=s.indexOf("/");if(x1>0){xcolumns[i].title=s.substring(0,x1);xcolumns[i].name=s.substring(x1+1);}else{xcolumns[i].title=s;xcolumns[i].name=s;}if(xcolumns[i].align==""&&xcolumns[i].type=="d"){xcolumns[i].align="c";}if(xcolumns[i].align==""&&xcolumns[i].type=="n"){xcolumns[i].align="r";}if(xcolumns[i].align==""&&xcolumns[i].type=="f"){xcolumns[i].align="r";}if(xcolumns[i].align=="c"){xcolumns[i].align="center";}else{if(xcolumns[i].align=="r"){xcolumns[i].align="right";}else{xcolumns[i].align="left";}}if((xcolumns[i].type=="n"||xcolumns[i].type=="f")){var str="{title: xcolumns[i].title, field:xcolumns[i].name, sortable:false, width:xcolumns[i].length, halign:'center', align: xcolumns[i].align, formatter: function(value){\n";str+="	if (value!=undefined) value=(1.0*value).toFixed("+xcolumns[i].dec+");\n";str+="	else value='0';\n";if(xcolumns[i].type=="n"){str+="	if (value==undefined || value=='' || 1*value==0) value='&nbsp;';\n";}str+='	return \'<a href="javascript:void(0)" style="padding:0 0px; font-size:\'+(syslabel.fontsize-1)+\'px; color:#000000;" >';str+="<div>' + value+'</div></a>';}}\n";}else{if(xcolumns[i].type=="d"){var str="{title: xcolumns[i].title, field:xcolumns[i].name, sortable:false, width:xcolumns[i].length, halign:'center', align: xcolumns[i].align, formatter: function(value){\n";str+="	if (value=='' || value==undefined) value='&nbsp;';";str+='	return \'<a href="javascript:void(0)" style="padding:0 0px; font-size:\'+(syslabel.fontsize-1)+\'px; color:#000000;" >';str+="<div>' + value+'</div></a>';}}\n";}else{if(xcolumns[i].type=="g"){var str="{title:'', field:'sysfiletype', sortable:false, width:xcolumns[i].length, halign:'center', align:'center', formatter:function(value,row,index){\n";str+="	var v1=row."+xcolumns[i].name+";\n";str+="	var v2='"+xcolumns[i].title+".png';\n";str+="	if (v1.lastIndexOf('.pdf')>0) v2='pdf24.png';\n";str+="	else if (v1.lastIndexOf('.swf')>0) v2='swf24.png';\n";str+="	else if (v1.lastIndexOf('.doc')>0) v2='word24.png';\n";str+="	else if (v1.lastIndexOf('.xls')>0) v2='excel24.png';\n";str+="	else if (v1.lastIndexOf('.ppt')>0) v2='ppt24.png';\n";str+="	else if (v1.lastIndexOf('.rar')>0) v2='rar24.png';\n";str+="	else if (v1.lastIndexOf('.zip')>0) v2='zip24.png';\n";str+="	else if (v1.lastIndexOf('.mp3')>0) v2='audio24.png';\n";str+="	else if (v1.lastIndexOf('.wav')>0) v2='audio24.png';\n";str+="	else if (v1.lastIndexOf('.png')>0) v2='pct24.png';\n";str+="	else if (v1.lastIndexOf('.gif')>0) v2='pct24.png';\n";str+="	else if (v1.lastIndexOf('.jpg')>0) v2='pct24.png';\n";str+="	v2='system/images/'+v2;\n";str+='	return \'<a href="javascript:void(0)"><img border="0" style="height:20px; width:20px; border:0;" src="\'+v2+\'" /></a>\';}}\n';}else{var str="{title: xcolumns[i].title, field:xcolumns[i].name, nowrap:false, sortable:false, width:xcolumns[i].length, halign:'center', align: xcolumns[i].align, formatter: function(value){";str+="	if (value=='' || value==undefined) value='&nbsp;';";str+='	return \'<a href="javascript:void(0)" style="padding:0 0px; font-size:\'+syslabel.fontsize+\'px; color:#000000;" >';str+="<div>'+ value+'</div>";str+="</a>';";str+="}}\n";}}}eval("var s="+str+";");result.push(s);}return result;}function myLoadGridData(pmyGrid1,pageNumber){var myGrid1=pmyGrid1.id;if(pageNumber<=0){var opts=$("#"+pmyGrid1.id).datagrid("getPager").data("pagination").options;pageNumber=opts.pageNumber;}var pager=$("#"+pmyGrid1.id).datagrid("getPager");pager.pagination("refresh",{pageNumber:pageNumber});var opts=$("#"+pmyGrid1.id).datagrid("getPager").data("pagination").options;opts.pageNumber=pageNumber;var pageSize=opts.pageSize;if(pageSize!=undefined){pageSize=pmyGrid1.pagesize;}var opts=$("#"+pmyGrid1.id).datagrid("options");opts.pageNumber=pageNumber;opts.pageSize=pageSize;$.ajax({type:"Post",url:"system/easyui_getGridData.jsp",data:{database:sysdatabasestring,selectsql:pmyGrid1.activesql,keyfield:pmyGrid1.keyfield,sortfield:pmyGrid1.sortfield,limit:pageSize,start:(pageNumber-1)*pageSize,summeryfields:pmyGrid1.summeryfields},async:false,method:"post",success:function(data){eval("var source="+data+";");$("#"+pmyGrid1.id).datagrid("reload");$("#"+pmyGrid1.id).datagrid("loadData",source);var rowcount=$("#"+pmyGrid1.id).datagrid("getData").total+"";var width=(rowcount.length*6+8);if(width<25){width=25;}var px=width+"px";$(".datagrid-header-rownumber,.datagrid-cell-rownumber").css({"width":px});$("#"+pmyGrid1.id).datagrid("resize");if(rowcount>0){var rows=$("#"+pmyGrid1.id).datagrid("getRows");if(pmyGrid1.rowindex==undefined||pmyGrid1.rowindex<0||pmyGrid1.rowindex>=rowcount){pmyGrid1.rowindex=0;}$("#"+pmyGrid1.id).datagrid("selectRow",pmyGrid1.rowindex);pmyGrid1.record=rows[pmyGrid1.rowindex];pmyGrid1.pagenumber=pageNumber;pmyGrid1.pagecount=parseInt((rowcount-1)/pmyGrid1.pagesize)+1;}else{pmyGrid1.record=null;pmyGrid1.pagenumber=0;pmyGrid1.pagecount=-1;pmyGrid1.rowindex=-1;}pmyGrid1.rowcount=rowcount;myGridEvents(pmyGrid1.id,"onload");}});return pmyGrid1;}function myGridPaging(b){var a=b.id;$("#"+b.id).datagrid({pagination:true,pageSize:b.pagesize});var c=$("#"+b.id).datagrid("getPager").data("pagination").options;var d=$("#"+b.id).datagrid("getPager");d.pagination({pageList:[10,20,50,100,500],showPageList:false,beforePageText:"第",afterPageText:"页    共 {pages} 页",displayMsg:"当前显示{from}～{to}行，共{total}行",onRefresh:function(f,e){if(b.rowindex>=0){$("#myGrid1").datagrid("endEdit",b.rowindex);}b.rowindex=0;myLoadGridData(b,f);myGridEvents(b.id,"onRefresh");},onChangePageSize:function(e){if(b.rowindex>=0){$("#myGrid1").datagrid("endEdit",b.rowindex);}var f=$("#"+b.id).datagrid("options");f.pageSize=e;b.rowindex=0;myLoadGridData(b,1);myGridEvents(b.id,"onChangePageSize");},onSelectPage:function(f,e){if(b.rowindex>=0){$("#myGrid1").datagrid("endEdit",b.rowindex);}var g=$("#"+b.id).datagrid("options");g.pageNumber=f;g.pageSize=e;b.rowindex=0;myLoadGridData(b,f);myGridEvents(b.id,"onSelectPage");}});}function myGrid(b){if(b.summeryfields==undefined){b.summeryfields="";}var d="";if(b.top>0||b.left>0){d+='<div id="'+b.id+'_div" style="position:absolute;';if(b.top>0){d+=" top:"+b.top+"px;";}if(b.left>0){d+=" left:"+b.left+"px;";}d+='">';}d+='<div id="'+b.id+'" class="easyui-datagrid" data-options="';if(b.toolbar!=undefined&&b.toolbar!=""){d+="toolbar:"+b.toolbar+"";}d+='" style="position:absolute;" ></div>';if(b.top>0||b.left>0){d+="</div>";}$("#"+b.parent).append($(d));if(b.sortfield==undefined||b.sortfield==""){b.sortfield=b.keyfield;}if(b.checkonclick==undefined){b.checkonclick=1;}b.rowcount=0;b.columns=[];b.scrollcolumns=[];b.fixedcolumns=[];b.checkboxcolumn=[];b.scrollcolumns=myGridColumns(b.gridfields);b.fixedcolumns=(b.fixedcolumns).concat(myGridColumns(b.fixedfields));b.columns=(b.fixedcolumns).concat(b.scrollcolumns);if(b.checkbox!=""){b.checkboxcolumn.push({field:"checkedflag",width:20,checkbox:true,align:"center"});}if(b.fixedfields!=""){b.fixedcolumns=b.checkboxcolumn.concat(b.fixedcolumns);}else{b.fixedcolumns=b.checkboxcolumn;}if(b.width<=0){b.width="100%";}if(b.height<=0){b.height="100%";}var a=b.id;b.rowindex=-1;if(b.striped==undefined||b.striped==""){b.striped=false;}else{b.striped=true;}if(b.checkbox=="single"){var e=true;}else{var e=false;}$("#"+b.id).datagrid({title:"&nbsp;"+b.title,width:b.width,height:b.height,iconCls:"panelIcon",nowrap:true,remoteSort:false,sortOrder:"asc",pagePosition:"bottom",autoRowHeight:false,selectOnCheck:e,checkOnSelect:e,striped:b.striped,frozenColumns:[b.fixedcolumns],columns:[b.scrollcolumns]});$("#"+b.id).attr("xcontextmenu",b.menu);$("#"+b.id).attr("xcheckbox",b.checkbox);if(b.menu!=undefined&&b.menu!=""){$("#"+b.id).datagrid({onRowContextMenu:function(k,i,f){k.preventDefault();var h=$(this).attr("xcontextmenu");var g=$(this).attr("xcheckbox");if(g=="single"){$(this).datagrid("selectRow",i);}$("#"+h).menu("show",{left:k.pageX,top:k.pageY});myGridEvents(b.id,"onRowContextMenu");}});}if(b.title==""){$("#"+b.id).datagrid({noheader:true});}if(b.rownumbers){$("#"+b.id).datagrid({rownumbers:true});}if(b.collapsible){$("#"+b.id).datagrid({collapsible:true});}if(b.checkbox=="single"){$("#"+b.id).datagrid({singleSelect:true});}else{if(b.checkbox=="multiple"){$("#"+b.id).datagrid({singleSelect:false});}}if(b.sortablefields!=undefined&&b.sortablefields!=""){var c=$("#myGrid1").datagrid("options").columns[0];}$("#"+b.id).datagrid({onDblClickRow:function(f,g){myGridEvents(b.id,"onDblClickRow");},onSelect:function(f,g){b.record=g;b.rowindex=f;myGridEvents(b.id,"onSelect");},onClickRow:function(f,k){b.record=k;b.rowindex=f;if(b.checkonclick==0){}if(b.singleselect==1){var h=$("#myGrid1").datagrid("getRows");for(var g=0;g<h.length;g++){if(b.rowindex!=g){$(this).datagrid("unselectRow",g);}}$(this).datagrid("selectRow",b.rowindex);}myGridEvents(b.id,"onClickRow");},onClickCell:function(f,i,h){b.rowindex=f;b.cellfield=i;b.cellvalue=h;var g=$("#"+b.id).datagrid("getRows");b.record=g[b.rowindex];myGridEvents(b.id,"onClickCell");}});if(b.pagesize>0){myGridPaging(b);}return b;}function myIsRowChecked(d){var a=false;var c=$("#"+d.id);var e=c.datagrid("getChecked");for(var b=0;b<e.length;b++){if(d.record.rownumber==e[b].rownumber){a=true;break;}}return a;}function myCheckBoxChange(f,a){var e="";var c=a.split(";");for(var b=1;b<=c.length;b++){if(b==1&&c.length==1){var d=f;}else{var d=f+b;}if($("#"+d).is(":checked")){e+=";"+c[b-1];}}$("#"+f).val(e.substr(1));}function myGetComboxData(id,sql){$.ajax({type:"Post",url:"system/easyui_getComboxData.jsp",data:{database:sysdatabasestring,selectsql:sql},async:false,method:"post",success:function(data){var source=eval(data);$("#"+id).combobox({data:source});if(source.length<=12){$("#"+id).combobox({panelHeight:"auto"});}else{$("#"+id).combobox({panelHeight:12*(syslabel.fontsize+8)});}if(source.length>0){$("#"+id).combobox("setValue",eval("source[0]."+id));}},error:function(err){console.log(err);}});}function mySetComboxByIndex(id,index){if($("#"+id).length>0){var items=$("#"+id).combobox("getData");if(items.length>0&&index<items.length){$("#"+id).combobox("setValue",eval("items[index]."+id));}}}function mySelectComboByIndex(id,index){if($("#"+id).length>0){var items=$("#"+id).combobox("getData");if(items.length>0&&index<items.length){$("#"+id).combobox("select",eval("items[index]."+id));}}}function mySetTreeNodeByIndex(c,a){var b=$("#"+c).tree("getRoot");if(b.children){$("#"+c).tree("expand",b.target);}$("#"+c).tree("select",b.target);}function mySetFormValues(fieldset,source){var xfields=[];var k=0;if(fieldset==undefined||fieldset==""){$.each(source,function(id,value){xfields[k]=id;k++;});}else{xfields=fieldset.split(";");}for(var k=0;k<xfields.length;k++){var value=eval("source."+xfields[k]);if(value!=undefined){mySetValue(xfields[k],value);}}}function mySetReadonly(h,g){var e=[];if(h!=""){e=h.split(";");}else{var b=0;$("input, select, textarea").each(function(k){var c=$(this);if(c.attr("id")!=undefined&&c.attr("xid")!=undefined&&c.attr("xid")!=""){e[b]=c.attr("id");b++;}});}var i="";var a="";var m="";var f="";var d="";for(b=0;b<e.length;b++){var l=$("#"+e[b]);a=l.attr("id");i=l.attr("type");f=l.attr("hidden");if(a!=undefined&&f!="hidden"){if(i=="text"){$("#"+a).textbox("readonly",g);}else{if(i=="textarea"){$("#"+a).attr("readonly",g);}else{if(i=="combobox"){$("#"+a).combobox("readonly",g);}else{if(i=="checkbox"){$("#"+a).attr("disabled",g);}else{$("#"+a).attr("readonly",g);}}}}}}}function myShowPanel(f,a){var e=f.split(";");for(var d=0;d<e.length;d++){var b=$("#"+e[d]);if(e[d]!=""&&b.length>0){if(a){b.panel("open");}else{b.panel("close");}}}}function myShowButton(f,a){var e=f.split(";");for(var d=0;d<e.length;d++){var b=$("#"+e[d]);if(e[d]!=""&&b.length>0){if(a){b.show();}else{b.hide();}}}}function mySetEnabled(g,a){var f=g.split(";");for(var d=0;d<f.length;d++){var b=$("#"+f[d]);if(b.length>0){type=b.attr("xtype");if(type=="linkbutton"){if(a){b.linkbutton("enable");}else{b.linkbutton("disable");}}else{if(type="menuitem"){var e=$("#"+b.attr("xparent"));if(a){e.menu("enableItem",$("#"+f[d]));}else{e.menu("disableItem",$("#"+f[d]));}}}}}}function myClearForm(a){var c=[];var b=0;if(a==undefined||a==""){$("input, select, textarea").each(function(e){var d=$(this);id=d.attr("id");c[b]=id;b++;});}else{c=a.split(";");}for(var b=0;b<c.length;b++){mySetValue(c[b],"");}}function mySetValue(a,l){var h=$("#"+a);if(h.length>0){l=l+"";if(l!=""){l=l.replaceAll("<br>","\n");}var g=h.attr("type");if(g==undefined){var g=h.attr("xtype");}var e=h.attr("hidden");var m=h.attr("xparent");if(g=="text"&&e!="hidden"){h.textbox("setValue",l);}else{if(g=="combobox"){h.combobox("setValue",l);}else{if(g=="checkbox"){var b=h.attr("xgroupid");if(b==undefined||b==""){var d=h.attr("xtext");if((";"+l+";").indexOf(";"+d+";")>=0){var k=true;}else{var k=false;}$("#"+a).prop("checked",k);}}else{if(g=="checkboxgroup"){var f=h.attr("xitemcount");for(var c=0;c<f;c++){var k=false;var n=$("#"+a+(c+1));if((";"+l+";").indexOf(";"+n.attr("xtext")+";")>=0){var k=true;}else{var k=false;}n.prop("checked",k);}}else{if(g=="label"){h.html(l);}else{if(g=="image"){h.attr("src",l);myResizeImage(a,l,h.attr("xheight"),h.attr("xwidth"));}else{h.val(l);}}}}}}}}function myGetValue(a){var h=$("#"+a);var k="";if(h.length>0){var g=h.attr("type");if(g==undefined){var g=h.attr("xtype");}var c=h.attr("hidden");var l=h.attr("xparent");var f=1;if(g=="text"&&c!="hidden"){k=h.textbox("getValue");}else{if(g=="combobox"){k=h.combobox("getValue");}else{if(g=="checkbox"){if(h.is(":checked")){k=h.attr("xtext");}else{k="";}}else{if(g=="checkboxgroup"){var d=h.attr("xitemcount");var k="";for(var b=0;b<d;b++){if(b==1&&d==1){var e=a;}else{var e=a+(b+1);}if($("#"+e).is(":checked")){k+=";"+$("#"+e).attr("xtext");}}k=k.substr(1);}else{if(g=="label"){k=h.html();}else{if(g=="image"){k=h.attr("src");}else{k=h.val();}}}}}}}return trim(k);}function mySetRecordValuebyForm(record,fieldset){var xfields=[];if(fieldset==undefined||fieldset==""){k=0;$.each(record,function(id,value){xfields[k]=id;k++;});}else{xfields=fieldset.split(";");}for(var k=0;k<xfields.length;k++){eval("record."+xfields[k]+'="'+myGetValue(xfields[k])+'";');}return(record);}function mySetRecordValuebyJson(record,source){$.each(source,function(id,value){eval("record."+id+'="'+value+'";');});return(record);}function myGenJsonData(d,b){var e=[];if(b==undefined||b==""){c=0;$.each(d,function(g,f){e[c]=g;c++;});}else{e=b.split(";");}var a="{";for(var c=0;c<e.length;c++){if(c>0){a+=",";}a+='"'+e[c]+'":"'+myGetValue(e[c])+'"';}a+="}";return(a);}function myGenInsertSql(xsysdatabasestring,tablename){var fieldset="";$.ajax({type:"Post",url:"system//easyui_getEditableFields.jsp",data:{database:xsysdatabasestring,tablename:tablename},async:false,method:"post",success:function(data){eval("fieldset="+data+";");}});var sql="";if(fieldset!=""){var insertsql1="insert into "+tablename+"(";var insertsql2="values(";for(var i=0;i<fieldset.length;i++){var field=fieldset[i].field;if(i>0){insertsql1+=",";insertsql2+=",";}insertsql1+=field;insertsql2+="'"+myToSqlValue(myGetValue(field))+"'";}sql+=insertsql1+") "+insertsql2+")";}return(sql);}function myGenUpdateSql(xsysdatabasestring,tablename,keyfield){var fieldset="";$.ajax({type:"Post",url:"system//easyui_getEditableFields.jsp",data:{database:xsysdatabasestring,tablename:tablename},async:false,method:"post",success:function(data){eval("fieldset="+data+";");}});var sql="";if(fieldset.length>0){sql="update "+tablename+" set ";for(var i=0;i<fieldset.length;i++){if(i>0){sql+=",";}var field=fieldset[i].field;sql+=field+"='"+myToSqlValue(myGetValue(field))+"'";}sql+=" where "+keyfield+"='"+myToSqlValue(myGetValue(keyfield))+"'";}return(sql);}function myKeyDownEvent(h){var g=[];var d=0;var f="";var b="";var e="";if(h!=undefined&&h!=""){g=h.split(";");}else{$("input").each(function(c){g[d]=$(this).attr("id");d++;});}for(d=0;d<g.length;d++){b=g[d];var a=$("#"+g[d]);f=a.attr("type");e=a.attr("hidden");if(b!=undefined&&a!=undefined&&e!="hidden"&&sys.keyeventcmp.indexOf(";"+f+";")>=0){myBindKeyDownEvent(b);}}}function myBindKeyDownEvent(c){var a=$("#"+c).attr("type");var b=$("#"+c);if(a!="checkbox"&&a!="textarea"&&a!="button"&&a!="file"){$("#"+c).textbox("textbox").bind("keydown",function(k){var h=k.which;var l=[];var o=[];var g=0;if(h==13||h==40||h==38){var d=-1;$("input").each(function(i){var e=$(this);field=e.attr("id");a=e.attr("type");hidden=e.attr("hidden");if(field!=undefined&&hidden!="hidden"){if(c==field){d=g;}l[g]=field;o[g]=a;g++;}});if(d<l.length&&d>=0){var m=0;if(h==13||h==40){if(d<=g){m=d+1;}else{m=g;}}else{if(h==38){if(d>0){m=d-1;}else{m=0;}}}var f=l[m];var o=o[m];if(o=="textarea"){$("#"+f).focus();}else{$("#"+f).next("span").find("input").focus();}}}});}}function myDisableCmp(b,a){var d=b.split(";");for(var c=0;c<d.length;c++){var e=$("#"+d[c]);if(e){var f=e.attr("class");if(f.indexOf("linkbutton")>=0){if(a){e.linkbutton("disable");}else{e.linkbutton("enable");}}else{if(f.indexOf("menubutton")>=0||f.indexOf("menu-item")>=0){if(a){e.menubutton({"disabled":true,hasDownArrow:false});}else{e.menubutton({"disabled":false,hasDownArrow:false});}}}}}}function myFocus(c){var a=$("#"+c);var b=a.attr("type");if(b=="textarea"){a.focus();}else{a.next("span").find("input").focus();}}function xmySelectOnFocus(){$("input").focus(function(){$(this).on("click.a keyup.a",function(a){$(this).off("click.a keyup.a").select();});});}function mySelectOnFocus(){$("input").on("focus",function(){var a=$(this).one("mouseup.mouseupSelect",function(){a.select();return false;}).one("mousedown",function(){a.off("mouseup.mouseupSelect");}).select();});}function myGetChartXMLHeader(a){var b='<chart caption="'+a.title+'" XAxisName="'+a.xAxisName+'" YAxisName="'+a.yAxisName+'"';b+='\n numberPrefix="" showValues="0" formatNumberScale="0" showAboutMenuItem="0"';b+='\n seriesNameInToolTip="1" chartTopMargin="10" chartBottomMargin="10" chartLeftMargin="10" chartRightMargin="10"';b+='\n baseFont="宋体" baseFontSize="10"';b+='\n exportEnabled="1" exportDialogMessage="正在导出,请稍候..." exportFormats="JPEG=导出为JPG图片|PNG=导出为PNG图片|PDF=导出为PDF文件"';b+='\n exportDataMenuItemLabel="导出图片" showExportDataMenuItem="1" exportAtClient="1"';b+='\n useRoundEdges="1" animation="0" palette="2" >';return(b);}function myGetChartXMLFooter(a){var b="\n <styles>";b+="\n <definition>";b+='\n <style type="font" color="666666" name="CaptionFont" font="黑体" size="16" />';b+='\n <style type="font" name="SubCaptionFont" font="宋体" size="12" bold="0" />';b+="\n </definition>";b+="\n <application>";b+='\n <apply toObject="caption" styles="CaptionFont" />';b+='\n <apply toObject="SubCaption" styles="SubCaptionFont" />';b+="\n </application>";b+="\n </styles>";b+="\n </chart>";return(b);}function myGetFunnelXML(pmyChart){var xml='<chart caption="销售额排名前10名" decimals="0" numberPrefix="$" streamlinedData="0" bgColor="f7f2ea" borderColor="f7f2ea" chartLeftMargin="50" chartRightMargin="50" chartTopMargin="5" chartBottomMargin="5" baseFont="宋体" baseFontSize="12" exportEnabled="1" showAboutMenuItem="0" borderthickness="0" bgAlpha="100" >';for(var i=0;i<pmyChart.data.length;i++){var s1=eval("pmyChart.data["+i+"]."+pmyChart.labelfield);var s2=eval("pmyChart.data["+i+"]."+pmyChart.valuefield);xml+="<set label='"+eval("pmyChart.data["+i+"]."+pmyChart.labelfield)+"'";xml+=" value='"+eval("pmyChart.data["+i+"]."+pmyChart.valuefield)+"'";if(pmyChart.sliced){xml+=" issliced='1'";}xml+=" />\n";}xml+="\n</chart>";return xml;}function myGetAngularXML(c){var b=70+parseInt(c.radius-c.label.length*12/2);var a=parseInt(c.height/2)+25;c.xml="";c.xml+='<chart bgCOlor="FFFFFF" upperLimit="'+c.max+'" lowerLimit="'+c.min+'" showAboutMenuItem="0" baseFontColor="FFFFFF"'+'\n majorTMNumber="9" majorTMColor="FFFFFF"  majorTMHeight="8" majorTMThickness="5" minorTMNumber="5" minorTMColor="FFFFFF"'+'\n	chartTopMargin="0" chartBottomMargin="0" minorTMHeight="3" minorTMThickness="2" pivotRadius="10" pivotBgColor="000000" pivotBorderColor="FFFFFF" '+'\n	pivotBorderThickness="2" hoverCapBorderColor="FFFFFF" toolTipBgColor="333333"  gaugeOuterRadius="110" '+'\n	gaugeScaleAngle="300" gaugeAlpha="0" decimalPrecision="0" displayValueDistance="0" showColorRange="0"'+'\n	placeValuesInside="1" pivotFillMix="" showPivotBorder="1" annRenderDelay="0">'+"\n	<dials>"+'\n	<dial value="'+c.value+'" bgColor="000000" borderColor="FFFFFF" borderAlpha="100" baseWidth="4" topWidth="4" editMode="1" borderThickness="2"/>'+"\n	</dials>"+"\n	<annotations>"+'\n	<annotationGroup xPos="'+parseInt(c.width/2)+'" yPos="'+parseInt(c.height/2)+'">'+'\n	<annotation type="circle" radius="'+c.radius+'" startAngle="0" endAngle="360" fillAsGradient="1" fillColor="4B4B4B, AAAAAA" fillAlpha="100,100"  fillRatio="95,5" />'+'\n	<annotation type="circle" xPos="0" yPos="0" radius="'+(c.radius-10)+'" startAngle="0" endAngle="360" showBorder="1" borderColor= "cccccc" fillAsGradient="1"  fillColor="ffffff, 000000"  fillAlpha="50,100"  fillRatio="1,99" />'+"\n	</annotationGroup>"+'\n	<annotationGroup xPos="'+b+'" yPos="'+a+'" showBelow="1">'+'\n	<annotation type="text" label="'+c.label+'" fontColor="FFFFFF" fontSize="12" isBold="0"/>'+"\n	</annotationGroup>"+"\n	</annotations>"+"\n</chart>";return(c.xml);}function myGetChartXML(pmyChart){var data=pmyChart.data;pmyChart.drilldownfields=[];if(pmyChart.drilldown!=undefined&&pmyChart.drilldown!=""){var x1=pmyChart.drilldown.indexOf("(");var x2=pmyChart.drilldown.indexOf(")");var s=pmyChart.drilldown.substring(x1+1,x2);var str="";pmyChart.drilldownfields=s.split(",");pmyChart.drilldown=pmyChart.drilldown.substring(0,x1);}pmyChart.xml="";var xml="\n";if(pmyChart.type=="single"||pmyChart.type=="ss"){for(var i=0;i<pmyChart.data.length;i++){var s1=eval("pmyChart.data["+i+"]."+pmyChart.labelfield);var s2=eval("pmyChart.data["+i+"]."+pmyChart.valuefield);xml+="<set label='"+eval("pmyChart.data["+i+"]."+pmyChart.labelfield)+"'";xml+=" value='"+eval("pmyChart.data["+i+"]."+pmyChart.valuefield)+"'";if(pmyChart.sliced){xml+=" issliced='1'";}if(pmyChart.drilldown!=undefined&&pmyChart.drilldown!=""){var pstr="";for(var m=0;m<pmyChart.drilldownfields.length;m++){var f=pmyChart.drilldownfields[m];if(f.substr(0,1)=='"'||f.substr(0,1)=="'"){var v=eval(f);}else{var v=eval("pmyChart.data["+i+"]."+f);}if(m>0){pstr+=",";}if(v!=undefined){pstr+='"'+v+'"';}else{pstr+='"'+f+'"';}}xml+=" link='javascript:"+pmyChart.drilldown+"("+pstr+")'";}xml+=" />\n";}pmyChart.xml=myGetChartXMLHeader(pmyChart);pmyChart.xml+=xml;console.log(xml);pmyChart.xml+=myGetChartXMLFooter(pmyChart);}else{if(pmyChart.type=="multiple"||pmyChart.type=="ms"){xml+="\n<categories>";for(var i=0;i<pmyChart.data.length;i++){var s1=eval("pmyChart.data["+i+"]."+pmyChart.labelfield);xml+='\n	<category label="'+s1+'" />';}xml+="\n</categories>";var yfields=pmyChart.valuefield.split(";");var ylabels=pmyChart.yAxisName.split(";");var xcolor=[];if(pmyChart.colorset!=undefined){xcolor=pmyChart.colorset.split(";");}j=0;for(var k=0;k<yfields.length;k++){xml+='\n<dataset seriesname="'+ylabels[k]+'"';if(k>0){xml+=' parentYAxis="S"';}xml+=" >";for(var i=0;i<pmyChart.data.length;i++){var s1=eval("pmyChart.data["+i+"]."+pmyChart.labelfield);var s2=eval("pmyChart.data["+i+"]."+yfields[k]);xml+="\n	<set ";if(xcolor.length>0){xml+=' color="'+xcolor[j]+'"';j++;if(j>=xcolor.length){j=0;}}xml+=' value="'+s2+'"';if(pmyChart.drilldown!=undefined&&pmyChart.drilldown!=""){var pstr="";for(var m=0;m<pmyChart.drilldownfields.length;m++){var f=pmyChart.drilldownfields[m];if(f.substr(0,1)=='"'||f.substr(0,1)=="'"){var v=eval(f);}else{var v=eval("pmyChart.data["+i+"]."+f);}if(m>0){pstr+=",";}if(v!=undefined){pstr+='"'+v+'"';}else{pstr+='"'+f+'"';}}xml+=" link='javascript:"+pmyChart.drilldown+"("+pstr+")'";}xml+=" />";}xml+="\n</dataset>";}pmyChart.xml=myGetChartXMLHeader(pmyChart);pmyChart.xml+=xml;pmyChart.xml+="\n"+myGetChartXMLFooter(pmyChart);}else{if(pmyChart.type=="angular"){pmyChart.xml=myGetAngularXML(pmyChart);}else{if(pmyChart.type=="funnel"){pmyChart.xml=myGetFunnelXML(pmyChart);}}}}return pmyChart;}function myShowFusionChart(h,c,a){var m=$("#"+a).width();var g=$("#"+a).height();var o=0;var b=0;var e=[];e[1]=";MSSpline;MSColumn3D;MSColumn3DLineDY;MSSplineArea;MSLine;MSColumn2D;MSColumnLine3D;MSArea;";e[1]+="Line;Column3D;Column2D;Area2D;";e[2]=";MSBar3D;MSBar2D;Bar2D;";e[3]=";Doughnut3D;Doughnut2D;Pie3D;Pie2D;";e[4]=";Pyramid;";e[5]=";funnel;";if(h.data!=undefined){var d=h.data.length;}else{var d=1;}for(var f=1;f<e.length-1;f++){e[f]=e[f].toLowerCase();}var l=";"+c.toLowerCase()+";";if(e[1].indexOf(l)>=0){o=Math.max(d*7*6+172,600);b=300;}else{if(e[2].indexOf(l)>=0){b=Math.max(Math.min(280+d*12,700),450);o=300;}else{if(e[3].indexOf(l)>=0){o=Math.max(Math.min(300+d*20,600),400);b=Math.max(Math.min(200+d*10,400),300);if(h.width>0){o=h.width;m=o;}if(h.height>0){b=h.height;g=b;}}else{if(e[4].indexOf(l)>=0){b=Math.max(Math.min(350+d*12,700),450);o=600;}}}}if(h.width<=0&&o<m){o="100%";}else{o=Math.max(o,h.width);}if(h.height<=0&&b<g){b="99%";}else{b=Math.max(b,h.height);}var k=new FusionCharts("jqeasyui/fusioncharts/swf/"+c+".swf","chartid_"+sys.fusionchartno,""+o+"",""+b+"","0","1");k.setDataXML(h.xml);k.render(a);sys.fusionchartno++;return h;}function myExportExcelReport(xsysdatabasestring,pmyReport1){pmyReport1.headercells=pmyReport1.headercells.replace(eval("/"+"%"+"/g"),"％");pmyReport1.footercells=pmyReport1.footercells.replace(eval("/"+"%"+"/g"),"％");var filename="";$.ajax({url:"system//easyui_toExcelFile.jsp?headercells="+pmyReport1.headercells+"&footercells="+pmyReport1.footercells,data:{database:xsysdatabasestring,template:pmyReport1.template,selectsql:pmyReport1.sql,fields:pmyReport1.fields,headerrange:pmyReport1.headerrange,regionrange:pmyReport1.regionrange},async:false,method:"post",success:function(data){eval("var result="+data);filename=result[0].filename;}});var xsourcefilename=filename;var url="system//easyui_fileDownLoad.jsp?source="+filename+"&target="+pmyReport1.targetfilename;window.location.href=url;return(url);}function myGenNewID(a,b){}function myGetIPAddress(){var source=[];$.ajax({url:"system/easyui_getIPAddress.jsp",async:false,method:"post",success:function(data){eval("source="+data);}});return source;}function myRunSelectSql(databasestring,sql){source=[];$.ajax({type:"Post",url:"system/easyui_execSelect.jsp",data:{database:sysdatabasestring,selectsql:sql},async:false,method:"post",success:function(data){source=eval(data);}});return source;}function myRunUpdateSql(databasestring,sql){if(tablename==undefined){var tablename="";}result={};$.ajax({type:"Post",url:"system/easyui_execUpdate.jsp",data:{database:sysdatabasestring,updatesql:sql},async:false,method:"post",success:function(data){eval("result="+data);},error:function(err){result="{'error':'"+err+"'}";}});return(result);}$.extend($.fn.linkbutton.methods,{enable:function(a){return a.each(function(){var d=$.data(this,"linkbutton");if($(this).hasClass("l-btn-disabled")){var b=d._eventsStore;if(b.href){$(this).attr("href",b.href);}if(b.onclicks){for(var c=0;c<b.onclicks.length;c++){$(this).bind("click",b.onclicks[c]);}}b.target=null;b.onclicks=[];$(this).removeClass("l-btn-disabled");}});},disable:function(a){return a.each(function(){var h=$.data(this,"linkbutton");if(!h._eventsStore){h._eventsStore={};}if(!$(this).hasClass("l-btn-disabled")){var f={};f.target=this;f.onclicks=[];var d=$(this).attr("href");if(d){f.href=d;$(this).attr("href","javascript:void(0)");}var g=$(this).attr("onclick");if(g&&g!=""){f.onclicks[f.onclicks.length]=new Function(g);$(this).attr("onclick","");}var b=$(this).data("events")||$._data(this,"events");if(b["click"]){var e=b["click"];for(var c=0;c<e.length;c++){if(e[c].namespace!="menu"){f.onclicks[f.onclicks.length]=e[c]["handler"];$(this).unbind("click",e[c]["handler"]);c--;}}}h._eventsStore=f;$(this).addClass("l-btn-disabled");}});}});$.fn.treegrid.defaults.loadFilter=function(c,d){var b=$.data(this,"treegrid").options;if(!b.columns){var a=$.data(this,"datagrid").options;b.columns=a.columns;b.frozenColumns=a.columns;}return c;};$.extend($.fn.tree.methods,{getLeafChildren:function(c,b){var a=[];$(b).next().children().children("div.tree-node").each(function(){a.push($(c[0]).tree("getNode",this));});return a;}});